<?xml version="1.0" encoding="UTF-8"?>
<!-- Do not edit this file with editors other than diagrams.net -->
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="1541px" height="2182px" viewBox="-0.5 -0.5 1541 2182" content="&lt;mxfile host=&quot;app.diagrams.net&quot; modified=&quot;2022-10-30T14:53:09.498Z&quot; agent=&quot;5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/106.0.0.0 Safari/537.36&quot; etag=&quot;vfWelerCQUitYBzvVf3M&quot; version=&quot;20.5.1&quot; type=&quot;device&quot;&gt;&lt;diagram id=&quot;z4_MealT-lZueBOhtil7&quot; name=&quot;Page-1&quot;&gt;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&lt;/diagram&gt;&lt;/mxfile&gt;" style="background-color: rgb(255, 255, 255);"><defs/><g><rect x="0" y="0" width="500" height="200" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 484px; height: 1px; padding-top: 7px; margin-left: 9px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><p style="line-height: 0.9; font-size: 14px;"></p><div style="font-size: 14px;"><b>Functional</b></div><div style="font-size: 14px;">1. 发布图文，视频</div><div style="font-size: 14px;">2. 关注，被关注</div><div style="font-size: 14px;">3. 浏览信息流</div><div style="font-size: 14px;"><br /></div><div style="font-size: 14px;"><b>Non-functional</b></div><div style="font-size: 14px;">1. Low latency：阅读信息流低响应时间</div><div style="font-size: 14px;"><span style="background-color: initial;">2. High </span><span style="background-color: initial;">Availability: </span><span style="background-color: initial;">保证整个系统的高可用</span></div><div style="font-size: 14px;"><div>3. High scalability: 支持大量用户使用</div></div><div style="font-size: 14px;"><br style="font-size: 14px;" /></div><p style="font-size: 14px;"></p></div></div></div></foreignObject><text x="9" y="21" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px">Functional...</text></switch></g><rect x="0" y="210" width="500" height="460" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 484px; height: 1px; padding-top: 217px; margin-left: 9px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><p style="line-height: 0.9; font-size: 14px;"></p><div style=""><div style=""><div style=""><b>Capacity Estimation (Optional)</b><br /></div><div style=""><b><br /></b></div><div style=""><b>QPS</b></div><div style="font-size: 14px;">假设：</div><div style="font-size: 14px;"><span style="white-space: pre;">	</span>一千万 DAU 用户 * 100 请求/天</div><div style="font-size: 14px;"><span style="background-color: initial;"><span style="white-space: pre;">	</span>读写比 = 100:1</span></div><div style="font-size: 14px;">结论：</div><div style="font-size: 14px;"><span style="white-space: pre;">	</span>系统需要支撑大约 10,000 QPS</div><div style="font-size: 14px;"><span style="background-color: initial;"><span style="white-space: pre;">	</span>read QPS </span><span style="background-color: initial;">≈ 10,000 QPS</span></div><div style="font-size: 14px;"><span style="background-color: initial;"><span style="white-space: pre;">	</span>write QPS </span><span style="background-color: initial;">≈ </span><span style="background-color: initial;">100 </span></div><div style="font-size: 14px;"><span style="background-color: initial;"><br /></span></div><div style="font-size: 14px;"><span style="background-color: initial;"><b>Storage</b></span></div><div style="font-size: 14px;"><span style="background-color: initial;">假设：</span></div><div style="font-size: 14px;"><span style="background-color: initial;"><span style="white-space: pre;">	</span>平均每个帖子占用空间为 5 Mb（包括图文与视频）</span></div><div style="font-size: 14px;">结论：</div><div style="font-size: 14px;"><span style="white-space: pre;">	</span>每天新增帖子数量为 9 百万条<br /></div><div style="font-size: 14px;"><span style="white-space: pre;">	</span>每天新增存储为 45 Tb<br /></div><div style="font-size: 14px;"><span style="background-color: initial;"><br /></span></div><div style=""><span style="background-color: initial;"><b>Throughout</b><br /></span></div><div style=""><span style="background-color: initial;">假设：</span></div><div style=""><span style="background-color: initial;"><span style="font-weight: bold; white-space: pre;">	</span>根据 QPS 和 Storage 的假设<br /></span></div><div style=""><span style="background-color: initial;"><span style="white-space: pre;">	</span>每次读取 20 条信息流<br /></span></div><div style=""><span style="background-color: initial;">结论：</span></div><div style=""><span style="background-color: initial;"><span style="white-space: pre;">	</span>下载带宽：2 百万条帖子/每秒 * 5 Mb = 10 Tb/s<br /></span></div><div style=""><span style="background-color: initial;"><span style="white-space: pre;">	</span>上传带宽：100 帖子/每秒 * 5 Mb = 500 Mb/s<br /></span></div><div style=""><span style="background-color: initial;"><b><br /></b></span></div><div style="font-size: 14px;"><span style="background-color: initial;"> </span></div></div></div><p style="font-size: 14px;"></p></div></div></div></foreignObject><text x="9" y="231" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px">Capacity Estimation (Optional)...</text></switch></g><rect x="0" y="680" width="500" height="440" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 484px; height: 1px; padding-top: 687px; margin-left: 9px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><p style="line-height: 0.9; font-size: 14px;"></p><div style=""><div style=""><div style=""><b style="background-color: initial;">练习与总结</b></div><div style=""><b style="background-color: initial;"><br /></b></div><div style=""><b style="background-color: initial;">Key points</b><br /></div><div style=""><b>- </b><span style="background-color: initial;">根据用户粉丝数量制定混合策略：</span><span style="background-color: initial;">Fanout /</span><span style="background-color: initial;">Pull/Push,</span></div><div>- 使用指针和日志追加型数据库记录多设备读取位置</div><div>- 保证 Read-Your-Writes Consistency</div><div>- 从用户 ID 或者数据 ID 维度进行数据存储分区</div><div><br /></div><div><div><b style="background-color: initial;">Patterns</b><br /></div><div>- Asynchronous Request-Reply pattern: <span style="background-color: initial;">异步上传图片和视频，无需等待上传完成就能继续其他任务</span></div><div>- <span style="background-color: initial;">Retry pattern: 上传资源或发布评论失败后可以自动进行重试。</span></div><div><span style="background-color: initial;">- </span><span style="background-color: initial;">Sharding pattern: 对用户或者资源进行分片存储</span></div></div><div style=""><b><br /></b></div><div><b>Real Life Architectures</b></div><div style=""><span style="background-color: initial;">- Video: Real-Time Delivery Architecture at Twitter</span><br /></div><div>- Video: How We Learned to Stop Worrying and Love Fan-In at Twitter</div><div>- Blog: <span style="background-color: initial;">Sharding &amp; IDs at Instagram</span></div><div>- Blog: <span style="background-color: initial;">Video Upload Latency Improvements at Instagram</span><br /></div><div><br /></div><div><div><div><b>Similar applications</b></div><div>- IM：在群组中，每条信息需要发布到多个其他成员（fanout）</div><div><span style="background-color: initial;">- Video</span>：上传视频以及浏览视频</div></div></div></div></div><p style="font-size: 14px;"></p></div></div></div></foreignObject><text x="9" y="701" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px">练习与总结Key points...</text></switch></g><rect x="510" y="0" width="1030" height="1120" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><path d="M 620 200 L 640 200 L 630 200 L 643.63 200" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 648.88 200 L 641.88 203.5 L 643.63 200 L 641.88 196.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><ellipse cx="580" cy="200" rx="40" ry="40" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 78px; height: 1px; padding-top: 200px; margin-left: 541px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">Client</div></div></div></foreignObject><text x="580" y="204" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">Client</text></switch></g><path d="M 770 290 L 803.63 290" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 808.88 290 L 801.88 293.5 L 803.63 290 L 801.88 286.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><rect x="650" y="260" width="120" height="60" rx="9" ry="9" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 290px; margin-left: 651px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><div>Media Server</div></div></div></div></foreignObject><text x="710" y="294" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">Media Server</text></switch></g><path d="M 770 200 L 803.63 200" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 808.88 200 L 801.88 203.5 L 803.63 200 L 801.88 196.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><path d="M 770 200 L 790 200 L 790 120 L 803.63 120" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 808.88 120 L 801.88 123.5 L 803.63 120 L 801.88 116.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><path d="M 710 230 L 710 250 L 710 240 L 710 253.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 710 258.88 L 706.5 251.88 L 710 253.63 L 713.5 251.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><rect x="650" y="170" width="120" height="60" rx="13.2" ry="13.2" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 200px; margin-left: 651px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">API Gateway</div></div></div></foreignObject><text x="710" y="204" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">API Gateway</text></switch></g><path d="M 1075 200 L 1112.5 200 L 1112.5 120 L 1133.63 120" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 1138.88 120 L 1131.88 123.5 L 1133.63 120 L 1131.88 116.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><path d="M 965 230 L 985 170 L 1085 170 L 1065 230 Z" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 200px; margin-left: 966px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">Queue</div></div></div></foreignObject><text x="1025" y="204" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">Queue</text></switch></g><path d="M 1200 150 L 1200 241.13" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 1200 246.38 L 1196.5 239.38 L 1200 241.13 L 1203.5 239.38 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 212px; margin-left: 1200px;"><div data-drawio-colors="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; background-color: rgb(255, 255, 255); white-space: nowrap;">aync</div></div></div></foreignObject><text x="1200" y="215" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="11px" text-anchor="middle">aync</text></switch></g><path d="M 1200 150 L 1200 190 L 1365 190 L 1365 241.13" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 1365 246.38 L 1361.5 239.38 L 1365 241.13 L 1368.5 239.38 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 191px; margin-left: 1281px;"><div data-drawio-colors="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; background-color: rgb(255, 255, 255); white-space: nowrap;">sync</div></div></div></foreignObject><text x="1281" y="194" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="11px" text-anchor="middle">sync</text></switch></g><rect x="1140" y="90" width="120" height="60" rx="9" ry="9" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 120px; margin-left: 1141px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">Work Server</div></div></div></foreignObject><text x="1200" y="124" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">Work Server</text></switch></g><path d="M 1310 262.5 C 1310 254.22 1334.62 247.5 1365 247.5 C 1379.59 247.5 1393.58 249.08 1403.89 251.89 C 1414.21 254.71 1420 258.52 1420 262.5 L 1420 322.5 C 1420 330.78 1395.38 337.5 1365 337.5 C 1334.62 337.5 1310 330.78 1310 322.5 Z" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><path d="M 1420 262.5 C 1420 270.78 1395.38 277.5 1365 277.5 C 1334.62 277.5 1310 270.78 1310 262.5" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 305px; margin-left: 1311px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">Database</div></div></div></foreignObject><text x="1365" y="309" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">Database</text></switch></g><rect x="520" y="390" width="1010" height="150" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 994px; height: 1px; padding-top: 397px; margin-left: 529px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><p style="line-height: 0.9; font-size: 14px;"></p><div style=""><div style=""><div style="">1. Client 向 Token Server 申请上传 Token 用作资源（图片，视频）上传，Token 记录过期时间以及权限等信息</div><div style="">2. Client 通过 Media Server 将资源上传到 Media Storage，上传完成后 Media Storage 会返回资源元数据给 Client</div><div style="">3. Client 将发布贴文时，将文字和对应的资源元数据通过 API Gateway 发送到 Web Server，Web Server 将该事件发送到 Queue</div><div style="">4. Work Server 订阅了发布事件，它<span style="background-color: initial;">从 User Relationship (Graph Database) 获取关注了此用户的关注者数量，</span><span style="background-color: initial;">根据关注者数量决定使用哪种策略：</span></div><div style=""><span style="">	</span><span style="white-space: pre;">	</span>4.1 关注者数量少：使用 Fanout，将数据写入到 Database，然后将该 Post ID 插入到每位关注者的 Timeline Cache 中（Timeline Cache 仅包括 Post ID, <span style="white-space: pre;">	</span>      User ID 的对应关系）</div><div style=""><span style="">	</span><span style="white-space: pre;">	</span>4.2 关注者数量多：将数据写入到 Database 中，待关注者浏览信息流的时候再将 Post ID 写入到该关注者的 Timeline Cache 中<br /></div><div style="font-size: 14px;"><br /></div></div></div><p style="font-size: 14px;"></p></div></div></div></foreignObject><text x="529" y="411" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px">1. Client 向 Token Server 申请上传 Token 用作资源（图片，视频）上传，Token 记录过期时间以及权限等信息...</text></switch></g><rect x="0" y="1130" width="500" height="620" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 491px; height: 1px; padding-top: 1137px; margin-left: 9px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><p style="line-height: 0.9; font-size: 14px;"></p><div style="font-size: 16px;"><div style=""><div style=""><b>API Design</b></div><div style=""><b><br /></b></div><div style="">method: POST</div><div style="">https://example.com/api/v1/news/</div><div style=""><b><br /></b></div><div style="">upload_resources(user_id, resources)</div><div style=""><span style="">	</span><span style="">	</span><span style="white-space: pre;">	</span>meta_data = get_meta(<span style="">	</span><span style="">	</span><span style="background-color: initial;">resources)</span><br /></div><div style=""><span style="background-color: initial;"><span style="">	</span><span style="">	</span><span style="">	</span><span style="">	</span><span style="">	</span><span style="white-space: pre;">	</span>token = </span><span style="background-color: initial;">get_token(user_id, </span><span style="background-color: initial;">meta_data</span><span style="background-color: initial;">)</span></div><div style=""><span style="background-color: initial;"><span style="">	</span><span style="">	</span><span style="white-space: pre;">	</span>upload_info = upload(user_id, token, resources)<br /></span></div><div style=""><span style="background-color: initial;"><span style="">	</span><span style="">	</span><span style="">	</span><span style="white-space: pre;">	</span>return upload_info<br /></span></div><div style=""><span style="background-color: initial;"><br /></span></div><div style="">post(user_id, resource, text)</div><div style=""><span style="background-color: initial;"><span style="">	</span></span><span style="">	</span><span style="">	</span><span style="white-space: pre;">	</span>upload_info<span style="background-color: initial;"> = upload_resources(user_id, resources)</span></div><div style=""><span style="background-color: initial;"><span style="">	</span><span style="">	</span><span style="">	</span><span style="white-space: pre;">	</span>if upload_info.status == Success<br /></span></div><div style=""><span style=""><span style=""></span><span style="">	</span><span style="">	<span style="">	</span></span><span style="white-space: pre;">	</span><span style="white-space: pre;">	</span>post_info</span> = send(user_id, text, res)</div><div style="">	<span style="">	</span><span style="">	</span><span style="white-space: pre;">	</span>return post_info</div><div style=""><br /></div><div style=""><div>method: GET</div><div>https://example.com/api/v1/news/?user_id=1<span style="background-color: initial;">&amp;offset=2</span></div><div><br /></div></div><div style=""><div>read(user_id, offset):</div></div></div></div><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div style="font-size: 16px;"><div style=""><div style="">meta_data = <span style="background-color: initial;">get_timeline(user_id, offset)</span></div><div>resources = get_resources(meta_data)</div><div>newsfeed = merge(<span style="background-color: initial;">meta_data, </span><span style="background-color: initial;">resources)</span></div><div style="">return newsfeed</div></div></div></blockquote><div style="font-size: 16px;"><div style=""><div style=""><span style="background-color: initial;"><span style="">	</span></span></div><div style=""><br /></div><div style=""><span style="background-color: initial;"><br /></span></div><div style=""><span style="background-color: initial;"><br /></span></div><div style=""><span style="">	</span><span style="">	</span><br /></div></div></div><p style="font-size: 14px;"></p></div></div></div></foreignObject><text x="9" y="1151" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px">API Design...</text></switch></g><rect x="510" y="1130" width="1030" height="620" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 1021px; height: 1px; padding-top: 1137px; margin-left: 519px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><p style="line-height: 0.9; font-size: 14px;"></p><div style=""><div style=""><div style=""><br /></div></div></div><p style="font-size: 14px;"></p></div></div></div></foreignObject><text x="519" y="1151" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px">...</text></switch></g><path d="M 532.5 1180 L 532.5 1150 L 1520 1150 L 1520 1180" fill="rgb(255, 255, 255)" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><path d="M 532.5 1180 L 532.5 1300 L 1520 1300 L 1520 1180" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 532.5 1180 L 1520 1180" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 532.5 1220 L 860.5 1220 L 1189.5 1220 L 1520.5 1220" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 532.5 1260 L 860.5 1260 L 1189.5 1260 L 1520.5 1260" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 860.5 1180 L 860.5 1220 L 860.5 1260 L 860.5 1300" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1189.5 1180 L 1189.5 1220 L 1189.5 1260 L 1189.5 1300" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="rgb(0, 0, 0)" font-family="Helvetica" font-weight="bold" pointer-events="none" text-anchor="middle" font-size="14px"><text x="1025.75" y="1170.5">User (SQL)</text></g><path d="M 532.5 1180 M 860.5 1180 M 860.5 1220 M 532.5 1220" fill="none" stroke="#999999" stroke-linecap="square" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 326px; height: 1px; padding-top: 1200px; margin-left: 534px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center; max-height: 36px; overflow: hidden;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">Name</div></div></div></foreignObject><text x="697" y="1204" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">Name</text></switch></g><path d="M 860.5 1180 M 1189.5 1180 M 1189.5 1220 M 860.5 1220" fill="none" stroke="#999999" stroke-linecap="square" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 327px; height: 1px; padding-top: 1200px; margin-left: 862px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center; max-height: 36px; overflow: hidden;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">Type</div></div></div></foreignObject><text x="1025" y="1204" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">Type</text></switch></g><path d="M 1189.5 1180 M 1520.5 1180 M 1520.5 1220 M 1189.5 1220" fill="none" stroke="#999999" stroke-linecap="square" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 329px; height: 1px; padding-top: 1200px; margin-left: 1191px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center; max-height: 36px; overflow: hidden;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">Note</div></div></div></foreignObject><text x="1355" y="1204" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">Note</text></switch></g><path d="M 532.5 1220 M 860.5 1220 M 860.5 1260 M 532.5 1260" fill="none" stroke="#999999" stroke-linecap="square" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 326px; height: 1px; padding-top: 1240px; margin-left: 534px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center; max-height: 36px; overflow: hidden;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">user_id</div></div></div></foreignObject><text x="697" y="1244" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">user_id</text></switch></g><path d="M 860.5 1220 M 1189.5 1220 M 1189.5 1260 M 860.5 1260" fill="none" stroke="#999999" stroke-linecap="square" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 327px; height: 1px; padding-top: 1240px; margin-left: 862px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center; max-height: 36px; overflow: hidden;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">UUID</div></div></div></foreignObject><text x="1025" y="1244" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">UUID</text></switch></g><path d="M 1189.5 1220 M 1520.5 1220 M 1520.5 1260 M 1189.5 1260" fill="none" stroke="#999999" stroke-linecap="square" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 329px; height: 1px; padding-top: 1240px; margin-left: 1191px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center; max-height: 36px; overflow: hidden;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">Primary key</div></div></div></foreignObject><text x="1355" y="1244" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">Primary key</text></switch></g><path d="M 532.5 1260 M 860.5 1260 M 860.5 1300 M 532.5 1300" fill="none" stroke="#999999" stroke-linecap="square" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 326px; height: 1px; padding-top: 1280px; margin-left: 534px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center; max-height: 36px; overflow: hidden;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">meta_data</div></div></div></foreignObject><text x="697" y="1284" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">meta_data</text></switch></g><path d="M 860.5 1260 M 1189.5 1260 M 1189.5 1300 M 860.5 1300" fill="none" stroke="#999999" stroke-linecap="square" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 327px; height: 1px; padding-top: 1280px; margin-left: 862px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center; max-height: 36px; overflow: hidden;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">multiple</div></div></div></foreignObject><text x="1025" y="1284" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">multiple</text></switch></g><path d="M 1189.5 1260 M 1520.5 1260 M 1520.5 1300 M 1189.5 1300" fill="none" stroke="#999999" stroke-linecap="square" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 329px; height: 1px; padding-top: 1280px; margin-left: 1191px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center; max-height: 36px; overflow: hidden;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">name, profile, etc.﻿</div></div></div></foreignObject><text x="1355" y="1284" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">name, profile, etc.﻿</text></switch></g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 127px; height: 1px; padding-top: 35px; margin-left: 521px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; font-weight: bold; white-space: normal; overflow-wrap: normal;">发布图文，视频</div></div></div></foreignObject><text x="584" y="40" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="16px" text-anchor="middle" font-weight="bold">发布图文，视频</text></switch></g><path d="M 930 200 L 950 200 L 945 200 L 968.63 200" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 973.88 200 L 966.88 203.5 L 968.63 200 L 966.88 196.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><rect x="810" y="170" width="120" height="60" rx="13.2" ry="13.2" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 200px; margin-left: 811px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">Web Server</div></div></div></foreignObject><text x="870" y="204" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">Web Server</text></switch></g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 88px; height: 1px; padding-top: 585px; margin-left: 521px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; font-weight: bold; white-space: normal; overflow-wrap: normal;">浏览信息流</div></div></div></foreignObject><text x="565" y="590" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="16px" text-anchor="middle" font-weight="bold">浏览信息流</text></switch></g><path d="M 640 870 L 673.63 870" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 678.88 870 L 671.88 873.5 L 673.63 870 L 671.88 866.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 640 870 L 660 870 L 660 760 L 673.63 760" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 678.88 760 L 671.88 763.5 L 673.63 760 L 671.88 756.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><ellipse cx="600" cy="870" rx="40" ry="40" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 78px; height: 1px; padding-top: 870px; margin-left: 561px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">Client</div></div></div></foreignObject><text x="600" y="874" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">Client</text></switch></g><rect x="520" y="960" width="1010" height="120" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 994px; height: 1px; padding-top: 967px; margin-left: 529px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;"><p style="line-height: 0.9; font-size: 14px;"></p><div style=""><div style=""><div style="">1. Client 通过 API Gateway 访问 Timeline Mixer，Timeline Mixer 会通过 Timeline Service 和 Other Server（例如广告）合并 Client 的 NewsFeed，其中资源文件 会通过 CDN 获取</div><div style="font-size: 14px;">2. Timeline Service 从 Timeline Cache 中获取 Client 的 Post ID 列表，然后请求 User Service, Post Service 等组件获取贴文对应的数据</div></div></div><p style="font-size: 14px;"></p></div></div></div></foreignObject><text x="529" y="981" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px">1. Client 通过 API Gateway 访问 Timeline Mixer，Timeline Mixer 会通过 Timeline Service 和 Other Server（例如广告）合并 Client 的 NewsFeed，其中资源文件 会通过 CDN 获取...</text></switch></g><path d="M 1085 615 C 1085 606.72 1109.62 600 1140 600 C 1154.59 600 1168.58 601.58 1178.89 604.39 C 1189.21 607.21 1195 611.02 1195 615 L 1195 675 C 1195 683.28 1170.38 690 1140 690 C 1109.62 690 1085 683.28 1085 675 Z" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 1195 615 C 1195 623.28 1170.38 630 1140 630 C 1109.62 630 1085 623.28 1085 615" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 658px; margin-left: 1086px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">Database</div></div></div></foreignObject><text x="1140" y="662" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">Database</text></switch></g><path d="M 800 870 L 838.63 870" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 843.88 870 L 836.88 873.5 L 838.63 870 L 836.88 866.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><rect x="680" y="840" width="120" height="60" rx="13.2" ry="13.2" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 870px; margin-left: 681px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">API Gateway</div></div></div></foreignObject><text x="740" y="874" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">API Gateway</text></switch></g><rect x="810" y="90" width="120" height="60" rx="13.2" ry="13.2" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 120px; margin-left: 811px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">Token Server</div></div></div></foreignObject><text x="870" y="124" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">Token Server</text></switch></g><path d="M 530 1350 L 530 1320 L 1520 1320 L 1520 1350" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 530 1350 L 530 1450 L 1520 1450 L 1520 1350" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 530 1350 L 1520 1350" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 750 1350 L 750 1380 L 750 1410 L 750 1440" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><g fill="rgb(0, 0, 0)" font-family="Helvetica" font-weight="bold" pointer-events="none" text-anchor="middle" font-size="14px"><text x="1024.5" y="1340.5">News (NoSQL)</text></g><path d="M 530 1350 M 750 1350 M 750 1380 M 530 1380" fill="none" stroke="rgb(0, 0, 0)" stroke-linecap="square" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 218px; height: 1px; padding-top: 1365px; margin-left: 531px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center; max-height: 26px; overflow: hidden;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">news_id</div></div></div></foreignObject><text x="640" y="1369" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">news_id</text></switch></g><path d="M 750 1350 M 1520 1350 M 1520 1380 M 750 1380" fill="none" stroke="rgb(0, 0, 0)" stroke-linecap="square" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 762px; height: 1px; padding-top: 1365px; margin-left: 758px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left; max-height: 26px; overflow: hidden;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">user_id, resources_id_list, news_content, create_time</div></div></div></foreignObject><text x="758" y="1369" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px">user_id, resources_id_list, news_content, create_time</text></switch></g><path d="M 530 1380 M 750 1380 M 750 1410 M 530 1410" fill="none" stroke="rgb(0, 0, 0)" stroke-linecap="square" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 218px; height: 1px; padding-top: 1395px; margin-left: 531px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center; max-height: 26px; overflow: hidden;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">news_id</div></div></div></foreignObject><text x="640" y="1399" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">news_id</text></switch></g><path d="M 750 1380 M 1520 1380 M 1520 1410 M 750 1410" fill="none" stroke="rgb(0, 0, 0)" stroke-linecap="square" stroke-miterlimit="10" pointer-events="none"/><path d="M 530 1410 M 750 1410 M 750 1440 M 530 1440" fill="none" stroke="rgb(0, 0, 0)" stroke-linecap="square" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 218px; height: 1px; padding-top: 1425px; margin-left: 531px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center; max-height: 26px; overflow: hidden;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">news_id</div></div></div></foreignObject><text x="640" y="1429" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">news_id</text></switch></g><path d="M 750 1410 M 1520 1410 M 1520 1440 M 750 1440" fill="none" stroke="rgb(0, 0, 0)" stroke-linecap="square" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 762px; height: 1px; padding-top: 1425px; margin-left: 758px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left; max-height: 26px; overflow: hidden;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">user_id, resources_id_list, news_content, create_time</div></div></div></foreignObject><text x="758" y="1429" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px">user_id, resources_id_list, news_content, create_time</text></switch></g><rect x="810" y="260" width="120" height="60" rx="9" ry="9" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 290px; margin-left: 811px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;"><div>Media Storage</div></div></div></div></foreignObject><text x="870" y="294" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">Media Storage</text></switch></g><path d="M 1145 262.5 C 1145 254.22 1169.62 247.5 1200 247.5 C 1214.59 247.5 1228.58 249.08 1238.89 251.89 C 1249.21 254.71 1255 258.52 1255 262.5 L 1255 322.5 C 1255 330.78 1230.38 337.5 1200 337.5 C 1169.62 337.5 1145 330.78 1145 322.5 Z" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 1255 262.5 C 1255 270.78 1230.38 277.5 1200 277.5 C 1169.62 277.5 1145 270.78 1145 262.5" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 305px; margin-left: 1146px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">Timeline Cache</div></div></div></foreignObject><text x="1200" y="309" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">Timeline Cache</text></switch></g><path d="M 1125 870 L 1163.63 870" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 1168.88 870 L 1161.88 873.5 L 1163.63 870 L 1161.88 866.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 1065 840 L 1065 796.37" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 1065 791.12 L 1068.5 798.12 L 1065 796.37 L 1061.5 798.12 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 1065 840 L 1065 810 L 1210 810 L 1210 796.37" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 1210 791.12 L 1213.5 798.12 L 1210 796.37 L 1206.5 798.12 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><rect x="1005" y="840" width="120" height="60" rx="9" ry="9" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 870px; margin-left: 1006px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">Timeline Service</div></div></div></foreignObject><text x="1065" y="874" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">Timeline Service</text></switch></g><path d="M 1310 120 L 1266.37 120" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 1261.12 120 L 1268.12 116.5 L 1266.37 120 L 1268.12 123.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 1310 90 C 1310 81.72 1334.62 75 1365 75 C 1379.59 75 1393.58 76.58 1403.89 79.39 C 1414.21 82.21 1420 86.02 1420 90 L 1420 150 C 1420 158.28 1395.38 165 1365 165 C 1334.62 165 1310 158.28 1310 150 Z" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 1420 90 C 1420 98.28 1395.38 105 1365 105 C 1334.62 105 1310 98.28 1310 90" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 133px; margin-left: 1311px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">User<br />Relationship</div></div></div></foreignObject><text x="1365" y="137" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">User...</text></switch></g><path d="M 965 870 L 998.63 870" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 1003.88 870 L 996.88 873.5 L 998.63 870 L 996.88 866.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 905 840 L 905 796.37" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 905 791.12 L 908.5 798.12 L 905 796.37 L 901.5 798.12 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><rect x="845" y="840" width="120" height="60" rx="9" ry="9" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 870px; margin-left: 846px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">Timeline Mixer</div></div></div></foreignObject><text x="905" y="874" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">Timeline Mixer</text></switch></g><path d="M 1065 730 L 1065 710 L 1140 710 L 1140 696.37" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 1140 691.12 L 1143.5 698.12 L 1140 696.37 L 1136.5 698.12 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><rect x="1005" y="730" width="120" height="60" rx="9" ry="9" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 760px; margin-left: 1006px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">User Service</div></div></div></foreignObject><text x="1065" y="764" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">User Service</text></switch></g><path d="M 1210 730 L 1210 710 L 1140 710 L 1140 696.37" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 1140 691.12 L 1143.5 698.12 L 1140 696.37 L 1136.5 698.12 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><rect x="1150" y="730" width="120" height="60" rx="9" ry="9" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 760px; margin-left: 1151px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">Post Service</div></div></div></foreignObject><text x="1210" y="764" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">Post Service</text></switch></g><rect x="845" y="730" width="120" height="60" rx="9" ry="9" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 760px; margin-left: 846px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">Other Service</div></div></div></foreignObject><text x="905" y="764" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">Other Service</text></switch></g><path d="M 1170 840 C 1170 831.72 1194.62 825 1225 825 C 1239.59 825 1253.58 826.58 1263.89 829.39 C 1274.21 832.21 1280 836.02 1280 840 L 1280 900 C 1280 908.28 1255.38 915 1225 915 C 1194.62 915 1170 908.28 1170 900 Z" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 1280 840 C 1280 848.28 1255.38 855 1225 855 C 1194.62 855 1170 848.28 1170 840" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 883px; margin-left: 1171px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">Timeline Cache</div></div></div></foreignObject><text x="1225" y="887" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">Timeline Cache</text></switch></g><rect x="680" y="630" width="120" height="60" rx="9" ry="9" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 660px; margin-left: 681px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;"><div>Media Storage</div></div></div></div></foreignObject><text x="740" y="664" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">Media Storage</text></switch></g><path d="M 740 730 L 740 696.37" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 740 691.12 L 743.5 698.12 L 740 696.37 L 736.5 698.12 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><rect x="680" y="730" width="120" height="60" rx="9" ry="9" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 760px; margin-left: 681px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;"><div>CDN</div></div></div></div></foreignObject><text x="740" y="764" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">CDN</text></switch></g><path d="M 530 1490 L 530 1460 L 1520 1460 L 1520 1490" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 530 1490 L 530 1590 L 1520 1590 L 1520 1490" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 530 1490 L 1520 1490" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 750 1490 L 750 1520 L 750 1550 L 750 1580" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><g fill="rgb(0, 0, 0)" font-family="Helvetica" font-weight="bold" pointer-events="none" text-anchor="middle" font-size="14px"><text x="1024.5" y="1480.5">NewsFeed (NoSQL)</text></g><path d="M 530 1490 M 750 1490 M 750 1520 M 530 1520" fill="none" stroke="rgb(0, 0, 0)" stroke-linecap="square" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 218px; height: 1px; padding-top: 1505px; margin-left: 531px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center; max-height: 26px; overflow: hidden;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">news_id</div></div></div></foreignObject><text x="640" y="1509" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">news_id</text></switch></g><path d="M 750 1490 M 1520 1490 M 1520 1520 M 750 1520" fill="none" stroke="rgb(0, 0, 0)" stroke-linecap="square" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 762px; height: 1px; padding-top: 1505px; margin-left: 758px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left; max-height: 26px; overflow: hidden;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">user_id, other_data</div></div></div></foreignObject><text x="758" y="1509" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px">user_id, other_data</text></switch></g><path d="M 530 1520 M 750 1520 M 750 1550 M 530 1550" fill="none" stroke="rgb(0, 0, 0)" stroke-linecap="square" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 218px; height: 1px; padding-top: 1535px; margin-left: 531px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center; max-height: 26px; overflow: hidden;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">news_id</div></div></div></foreignObject><text x="640" y="1539" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">news_id</text></switch></g><path d="M 750 1520 M 1520 1520 M 1520 1550 M 750 1550" fill="none" stroke="rgb(0, 0, 0)" stroke-linecap="square" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 762px; height: 1px; padding-top: 1535px; margin-left: 758px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left; max-height: 26px; overflow: hidden;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">user_id, other_data</div></div></div></foreignObject><text x="758" y="1539" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px">user_id, other_data</text></switch></g><path d="M 530 1550 M 750 1550 M 750 1580 M 530 1580" fill="none" stroke="rgb(0, 0, 0)" stroke-linecap="square" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 218px; height: 1px; padding-top: 1565px; margin-left: 531px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center; max-height: 26px; overflow: hidden;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">news_id</div></div></div></foreignObject><text x="640" y="1569" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">news_id</text></switch></g><path d="M 750 1550 M 1520 1550 M 1520 1580 M 750 1580" fill="none" stroke="rgb(0, 0, 0)" stroke-linecap="square" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 762px; height: 1px; padding-top: 1565px; margin-left: 758px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left; max-height: 26px; overflow: hidden;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">user_id, other_data</div></div></div></foreignObject><text x="758" y="1569" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px">user_id, other_data</text></switch></g><path d="M 751 1380 M 1420 1380 M 1420 1410 M 751 1410" fill="none" stroke="rgb(0, 0, 0)" stroke-linecap="square" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 661px; height: 1px; padding-top: 1395px; margin-left: 759px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left; max-height: 26px; overflow: hidden;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">user_id, resources_id_list, news_content, create_time</div></div></div></foreignObject><text x="759" y="1399" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px">user_id, resources_id_list, news_content, create_time</text></switch></g><rect x="0" y="1760" width="1540" height="410" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 1531px; height: 1px; padding-top: 1767px; margin-left: 9px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;"><p style="line-height: 0.9; font-size: 14px;"></p><div style=""><div style=""><div style=""><font style="font-size: 14px;"><b>  </b></font><b style="background-color: initial;">Explain</b></div><div style=""><b style="background-color: initial;"><br /></b></div><div style=""><b style="background-color: initial;">  </b><span style="background-color: initial;">1. 为什么 </span><span style="background-color: initial;">Non-functional </span><span style="background-color: initial;">不关注 Consistency？</span></div><div style=""><span style="background-color: initial;">      大部分 NewsFeed 的业务要求 </span><span style="background-color: initial;">eventually </span><span style="background-color: initial;">consistency，少部分要求 strong </span><span style="background-color: initial;">consistency，所以这里没有强调，不过如果面试官关注的话，那么可以提出这点。（来源：</span><span style="background-color: initial;">https://blog.twitter.com/engineering/en_us/a/2014/manhattan-our-real-time-multi-tenant-distributed-database-for-twitter-scale）</span></div><div style=""><span style="background-color: initial;"><br /></span></div><div style=""><span style="background-color: initial;">  2. 为什么上传资源的时候，要使用 Media Service 而不直接上传到 Web Server？</span></div><div style=""><span style="background-color: initial;">      如果直接使用 Web Server 的话会浪费大量的带宽，因为 Web Server 接下来会将资源上传到 </span><span style="background-color: initial;">Media Service。</span><span style="background-color: initial;">拆分之后，使用 API Gateway 找到最佳的 </span><span style="background-color: initial;">Media Service 来负责上传功能</span><span style="background-color: initial;">，</span><span style="background-color: initial;">Media Service 可以根据上传功能调整物理分布以及专注在上传功能优化，Web Server 也可以专注在发布以及浏览信息流。</span></div><div style=""><span style="background-color: initial;"><br /></span></div><div style=""><span style="background-color: initial;">  3. 发布过程中的 User Relationship</span><span style="background-color: initial;"> 里面具体存储的是什么？</span></div><div style=""><span style="background-color: initial;">      里面以图的形式存储的是社交关系网，例如 A 关注了 B，C 评论的 D 是其中的两条边，Meta 使用的是 Tao（具体信息：</span><span style="background-color: initial;">https://engineering.fb.com/2013/06/25/core-data/tao-the-power-of-the-graph/），Twitter 使用的是 FlockDB（具体信息：</span><span style="background-color: initial;">https://blog.twitter.com/engineering/en_us/a/2010/introducing-flockdb）</span></div><div style=""><span style="background-color: initial;"><br /></span></div><div style=""><span style="background-color: initial;">  4. API Design 中，为什么使用 offset 来请求？这样在浏览过程中如果有新的 news，请求不会浏览到重复 news 吗？</span></div><div style=""><span style="background-color: initial;">      </span><span style="background-color: initial;">这里的 offset 指的是类似 start_after(id) 也就是每次 read 都会指定只从某个位置开始读取，不过这里要注意，如果 news 会被更新（例如股票行情），删除（该用户被封禁）</span><span style="background-color: initial;">或者它的赞或者热门评论会被更新。</span><span style="background-color: initial;">那么用户会期望浏览之前的 NewsFeed 可以看到实时更新的内容。这时候需要考虑 real time listener，具体细节参考：https://www.youtube.com/watch?v=poqTHxtDXwU</span></div><div style=""><span style="background-color: initial;"><br /></span></div><div style=""><span style="background-color: initial;">  5. 为什么 User 表选择 SQL，而其他表选择 NoSQL？</span></div><div style=""><span style="background-color: initial;">      </span><span style="background-color: initial;">User 表选择 SQL 是从功能扩展性进行考虑的，例如之后有用户修改个人资料的功能，那么我们会期望修改资料是 </span><span style="background-color: initial;">Atomic 的（虽然现在不少 NoSQL database 都支持 ACID，例如 Google Cloud 的 </span><span style="background-color: initial;">Firestore）实际应用上，Instagram 和 Twitter 的 User 表都是使用 NoSQL 进行存储的（</span><span style="background-color: initial;">Instagram 使用的是 Cassandra（来源：</span><span style="background-color: initial;">https://www.youtube.com/watch?v=_BfMH4GQWnk&amp;t=218s）</span><span style="background-color: initial;">，Twitter 使用的是 </span><span style="background-color: initial;">Manhattan（</span><span style="background-color: initial;">https://blog.twitter.com/engineering/en_us/a/2014/manhattan-our-real-time-multi-tenant-distributed-database-for-twitter-scale），News 和 NewsFeed 表使用 NoSQL 保证 High Scalability。</span></div><div><span style="background-color: initial;"><br /></span></div></div></div><p style="font-size: 14px;"></p></div></div></div></foreignObject><text x="9" y="1781" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px">Explain...</text></switch></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://www.diagrams.net/doc/faq/svg-export-text-problems" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Text is not SVG - cannot display</text></a></switch></svg>