"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[2971],{3905:(t,e,a)=>{a.d(e,{Zo:()=>u,kt:()=>d});var n=a(7294);function r(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function l(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function o(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?l(Object(a),!0).forEach((function(e){r(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function i(t,e){if(null==t)return{};var a,n,r=function(t,e){if(null==t)return{};var a,n,r={},l=Object.keys(t);for(n=0;n<l.length;n++)a=l[n],e.indexOf(a)>=0||(r[a]=t[a]);return r}(t,e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(n=0;n<l.length;n++)a=l[n],e.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(t,a)&&(r[a]=t[a])}return r}var s=n.createContext({}),p=function(t){var e=n.useContext(s),a=e;return t&&(a="function"==typeof t?t(e):o(o({},e),t)),a},u=function(t){var e=p(t.components);return n.createElement(s.Provider,{value:e},t.children)},c="mdxType",m={inlineCode:"code",wrapper:function(t){var e=t.children;return n.createElement(n.Fragment,{},e)}},k=n.forwardRef((function(t,e){var a=t.components,r=t.mdxType,l=t.originalType,s=t.parentName,u=i(t,["components","mdxType","originalType","parentName"]),c=p(a),k=r,d=c["".concat(s,".").concat(k)]||c[k]||m[k]||l;return a?n.createElement(d,o(o({ref:e},u),{},{components:a})):n.createElement(d,o({ref:e},u))}));function d(t,e){var a=arguments,r=e&&e.mdxType;if("string"==typeof t||r){var l=a.length,o=new Array(l);o[0]=k;var i={};for(var s in e)hasOwnProperty.call(e,s)&&(i[s]=e[s]);i.originalType=t,i[c]="string"==typeof t?t:r,o[1]=i;for(var p=2;p<l;p++)o[p]=a[p];return n.createElement.apply(null,o)}return n.createElement.apply(null,a)}k.displayName="MDXCreateElement"},1797:(t,e,a)=>{a.r(e),a.d(e,{assets:()=>s,contentTitle:()=>o,default:()=>m,frontMatter:()=>l,metadata:()=>i,toc:()=>p});var n=a(7462),r=(a(7294),a(3905));const l={sidebar_position:50},o="\u8bbe\u8ba1\u6a21\u5f0f",i={unversionedId:"\u7cfb\u7edf\u8bbe\u8ba1/\u8bbe\u8ba1\u6a21\u5f0f",id:"\u7cfb\u7edf\u8bbe\u8ba1/\u8bbe\u8ba1\u6a21\u5f0f",title:"\u8bbe\u8ba1\u6a21\u5f0f",description:"\u7279\u5b9a\u8bbe\u8ba1\u6a21\u5f0f",source:"@site/docs/\u7cfb\u7edf\u8bbe\u8ba1/\u8bbe\u8ba1\u6a21\u5f0f.md",sourceDirName:"\u7cfb\u7edf\u8bbe\u8ba1",slug:"/\u7cfb\u7edf\u8bbe\u8ba1/\u8bbe\u8ba1\u6a21\u5f0f",permalink:"/\u7cfb\u7edf\u8bbe\u8ba1/\u8bbe\u8ba1\u6a21\u5f0f",draft:!1,editUrl:"https://github.com/Interview-Science/Book/edit/main/docs/\u7cfb\u7edf\u8bbe\u8ba1/\u8bbe\u8ba1\u6a21\u5f0f.md",tags:[],version:"current",sidebarPosition:50,frontMatter:{sidebar_position:50},sidebar:"tutorialSidebar",previous:{title:"\u57fa\u672c\u7ec4\u4ef6",permalink:"/\u7cfb\u7edf\u8bbe\u8ba1/\u57fa\u7840\u7ec4\u4ef6"},next:{title:"\u4fe1\u606f\u6d41\u7cfb\u7edf",permalink:"/\u7cfb\u7edf\u8bbe\u8ba1/\u5206\u7c7b\u603b\u7ed3/\u4fe1\u606f\u6d41\u7cfb\u7edf"}},s={},p=[{value:"\u7279\u5b9a\u8bbe\u8ba1\u6a21\u5f0f",id:"\u7279\u5b9a\u8bbe\u8ba1\u6a21\u5f0f",level:2},{value:"Asynchronous Request-Reply Pattern",id:"asynchronous-request-reply-pattern",level:3},{value:"Compensating Transaction pattern",id:"compensating-transaction-pattern",level:3},{value:"Competing Consumers pattern",id:"competing-consumers-pattern",level:3},{value:"Event Sourcing pattern",id:"event-sourcing-pattern",level:3},{value:"CQRS pattern",id:"cqrs-pattern",level:3},{value:"Gatekeeper pattern",id:"gatekeeper-pattern",level:3},{value:"Geode pattern",id:"geode-pattern",level:3},{value:"Rate Limiting pattern",id:"rate-limiting-pattern",level:3},{value:"Saga distributed transactions pattern",id:"saga-distributed-transactions-pattern",level:3},{value:"Sharding pattern",id:"sharding-pattern",level:3},{value:"Valet Key pattern",id:"valet-key-pattern",level:3},{value:"\u901a\u7528\u8bbe\u8ba1\u6a21\u5f0f",id:"\u901a\u7528\u8bbe\u8ba1\u6a21\u5f0f",level:2},{value:"Ambassador pattern",id:"ambassador-pattern",level:3},{value:"Anti-corruption Layer pattern",id:"anti-corruption-layer-pattern",level:3},{value:"Cache-Aside pattern",id:"cache-aside-pattern",level:3},{value:"Health Endpoint Monitoring pattern",id:"health-endpoint-monitoring-pattern",level:3},{value:"Retry pattern &amp; Circuit Breaker pattern",id:"retry-pattern--circuit-breaker-pattern",level:3}],u={toc:p},c="wrapper";function m(t){let{components:e,...l}=t;return(0,r.kt)(c,(0,n.Z)({},u,l,{components:e,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"\u8bbe\u8ba1\u6a21\u5f0f"},"\u8bbe\u8ba1\u6a21\u5f0f"),(0,r.kt)("h2",{id:"\u7279\u5b9a\u8bbe\u8ba1\u6a21\u5f0f"},"\u7279\u5b9a\u8bbe\u8ba1\u6a21\u5f0f"),(0,r.kt)("h3",{id:"asynchronous-request-reply-pattern"},(0,r.kt)("a",{parentName:"h3",href:"https://docs.microsoft.com/en-us/azure/architecture/patterns/async-request-reply"},"Asynchronous Request-Reply Pattern")),(0,r.kt)("p",null,"\u670d\u52a1\u7aef\u9a6c\u4e0a\u8fd4\u56de\u5ba2\u6237\u7aef\u8bf7\u6c42\uff0c\u5e76\u4e14\u5f02\u6b65\u5904\u7406\u4efb\u52a1\uff0c\u5ba2\u6237\u7aef\u53ef\u4ee5\u7a0d\u540e\u67e5\u8be2\u4efb\u52a1\u72b6\u6001"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u4f55\u65f6\u4f7f\u7528")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"\u5e94\u7528"),(0,r.kt)("th",{parentName:"tr",align:null},"\u529f\u80fd"),(0,r.kt)("th",{parentName:"tr",align:null},"\u9700\u8981\u5173\u6ce8"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"CPU-bound"),(0,r.kt)("td",{parentName:"tr",align:null},"\u67e5\u8be2\u4efb\u52a1\u72b6\u6001"),(0,r.kt)("td",{parentName:"tr",align:null})))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u9700\u8981\u5173\u6ce8")),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://learn.microsoft.com/en-us/azure/architecture/patterns/async-request-reply#issues-and-considerations"},"Issues and considerations")),(0,r.kt)("p",null,"HTTP status code"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"There are a number of possible ways to implement this pattern over HTTP and not all upstream services have the same semantics. For example, most services won't return an HTTP 202 response back from a GET method when a remote process hasn't finished. Following pure REST semantics, they should return HTTP 404 (Not Found). This response makes sense when you consider the result of the call isn't present yet.")),(0,r.kt)("p",null,"Perform long-running tasks with the webhook action pattern"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"Legacy clients might not support this pattern. In that case, you might need to place a facade over the asynchronous API to hide the asynchronous processing from the original client. For example, Azure Logic Apps supports this pattern natively can be used as an integration layer between an asynchronous API and a client that makes synchronous calls. See Perform long-running tasks with the webhook action pattern.")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u5982\u4f55\u6267\u884c")),(0,r.kt)("p",null,"\u5177\u4f53\u7b56\u7565\u8bf7\u6d4f\u89c8\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://learn.microsoft.com/en-us/azure/architecture/patterns/async-request-reply#solution"},"Solution"))),(0,r.kt)("h3",{id:"compensating-transaction-pattern"},(0,r.kt)("a",{parentName:"h3",href:"https://docs.microsoft.com/en-us/azure/architecture/patterns/compensating-transaction"},"Compensating Transaction pattern")),(0,r.kt)("p",null,"\u4f7f\u7528\u4e8b\u52a1\u8865\u507f\u7684\u65b9\u5f0f\u4f7f\u591a\u6b65\u9aa4\u7684\u4e8b\u52a1\u4fdd\u6301\u6700\u7ec8\u4e00\u81f4\u6027"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u4f55\u65f6\u4f7f\u7528")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"\u5e94\u7528"),(0,r.kt)("th",{parentName:"tr",align:null},"\u529f\u80fd"),(0,r.kt)("th",{parentName:"tr",align:null},"\u9700\u8981\u5173\u6ce8"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Uber"),(0,r.kt)("td",{parentName:"tr",align:null},"\u53eb\u8f66\u6d41\u7a0b\u4e2d\u51fa\u9519\uff08\u53eb\u5230\u8f66\u4f46\u662f\u53f8\u673a\u53d6\u6d88\uff0c\u81ea\u52a8\u91cd\u65b0\u53eb\u8f66\uff09\u8fd8\u539f\u53f8\u673a\u4ee5\u53ca\u4e58\u5ba2\u72b6\u6001"),(0,r.kt)("td",{parentName:"tr",align:null},"Retry")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"File Sync"),(0,r.kt)("td",{parentName:"tr",align:null},"\u6587\u4ef6\u540c\u6b65\u8fc7\u7a0b\u51fa\u9519\uff08\u6587\u4ef6\u5939\u540d\u88ab\u5360\u7528\uff0c\u81ea\u52a8\u4fee\u6539\uff09\uff0c\u8fd8\u539f\u6587\u4ef6\u72b6\u6001"),(0,r.kt)("td",{parentName:"tr",align:null},"Retry")))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u9700\u8981\u5173\u6ce8")),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://docs.microsoft.com/en-us/azure/architecture/patterns/compensating-transaction#issues-and-considerations"},"Issues and considerations")),(0,r.kt)("p",null,"Order"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"The order of the steps in the compensating transaction doesn't necessarily have to be the exact opposite of the steps in the original operation. For example, one data store might be more sensitive to inconsistencies than another, and so the steps in the compensating transaction that undo the changes to this store should occur first.")),(0,r.kt)("p",null,"Fail "),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"A compensating transaction is also an eventually consistent operation and it could also fail. The system should be able to resume the compensating transaction at the point of failure and continue. It might be necessary to repeat a step that's failed, so the steps in a compensating transaction should be defined as idempotent commands. ")),(0,r.kt)("p",null,"Retry logic"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"Only stop the operation and initiate a compensating transaction if a step fails repeatedly or cannot be recovered.")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u5982\u4f55\u6267\u884c")),(0,r.kt)("p",null,"\u5177\u4f53\u7b56\u7565\u8bf7\u6d4f\u89c8\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://docs.microsoft.com/en-us/azure/architecture/patterns/compensating-transaction#solution"},"Solution"))),(0,r.kt)("h3",{id:"competing-consumers-pattern"},(0,r.kt)("a",{parentName:"h3",href:"https://docs.microsoft.com/en-us/azure/architecture/patterns/competing-consumers"},"Competing Consumers pattern")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://docs.microsoft.com/en-us/azure/architecture/patterns/publisher-subscriber"},"Publisher-Subscriber pattern")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://docs.microsoft.com/en-us/azure/architecture/patterns/priority-queue"},"Priority Queue pattern")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://docs.microsoft.com/en-us/azure/architecture/patterns/queue-based-load-leveling"},"Queue-Based Load Leveling pattern"))),(0,r.kt)("h3",{id:"event-sourcing-pattern"},(0,r.kt)("a",{parentName:"h3",href:"https://docs.microsoft.com/en-us/azure/architecture/patterns/event-sourcing"},"Event Sourcing pattern")),(0,r.kt)("p",null,"\u4f7f\u7528 append-only \u7684\u65b9\u5f0f\u6765\u8bb0\u5f55\u6240\u6709\u6570\u636e\u7684\u53d8\u5316\uff0c\u65b9\u4fbf\u8fdb\u884c\u6570\u636e\u6eaf\u6e90\u4ee5\u53ca\u4fdd\u8bc1\u4e86\u6570\u636e\u7684\u4e00\u81f4\u6027\uff0c\u4e5f\u80fd\u63d0\u4f9b\u4e8b\u52a1\u8865\u507f\u529f\u80fd\u3002"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u4f55\u65f6\u4f7f\u7528")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"\u5e94\u7528"),(0,r.kt)("th",{parentName:"tr",align:null},"\u529f\u80fd"),(0,r.kt)("th",{parentName:"tr",align:null},"\u9700\u8981\u5173\u6ce8"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Shopping"),(0,r.kt)("td",{parentName:"tr",align:null},"\u8d2d\u7269\u7684\u6574\u4e2a\u6d41\u7a0b\u62c6\u5206\u6210\u4e0d\u540c\u7684\u4e8b\u4ef6"),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Ranking"),(0,r.kt)("td",{parentName:"tr",align:null},"\u6bcf\u6b21\u7528\u6237\u4f7f\u7528\u8be5\u6570\u636e\uff08Hashtag\uff0c\u542c\u6b4c\uff09\u5219\u4ea7\u751f\u591a\u4e2a\u4e8b\u4ef6"),(0,r.kt)("td",{parentName:"tr",align:null})))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u9700\u8981\u5173\u6ce8")),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://learn.microsoft.com/en-us/azure/architecture/patterns/event-sourcing#issues-and-considerations"},"Issues and considerations")),(0,r.kt)("p",null,"Eventually consistent"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"The system will only be eventually consistent when creating materialized views or generating projections of data by replaying events. There's some delay between an application adding events to the event store as the result of handling a request, the events being published, and consumers of the events handling them. During this period, new events that describe further changes to entities might have arrived at the event store.")),(0,r.kt)("p",null,"Difficult to update"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"If the format (rather than the data) of the persisted events needs to change, perhaps during a migration, it can be difficult to combine existing events in the store with the new version.")),(0,r.kt)("p",null,"Idempotent"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"Event publication might be at least once, and so consumers of the events must be idempotent. ")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u5982\u4f55\u6267\u884c")),(0,r.kt)("p",null,"\u5177\u4f53\u7b56\u7565\u8bf7\u6d4f\u89c8\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://learn.microsoft.com/en-us/azure/architecture/patterns/event-sourcing#solution"},"Solution"))),(0,r.kt)("h3",{id:"cqrs-pattern"},(0,r.kt)("a",{parentName:"h3",href:"https://docs.microsoft.com/en-us/azure/architecture/patterns/cqrs"},"CQRS pattern")),(0,r.kt)("p",null,"\u5206\u5f00\u8bfb\u548c\u5199\u7684\u64cd\u4f5c\u4ee5\u53ca\u5b58\u50a8\uff0c\u901a\u5e38\u548c Event Sourcing pattern \u4e0e Materialized View pattern \u4e00\u8d77\u4f7f\u7528"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u4f55\u65f6\u4f7f\u7528")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"\u5e94\u7528"),(0,r.kt)("th",{parentName:"tr",align:null},"\u529f\u80fd"),(0,r.kt)("th",{parentName:"tr",align:null},"\u9700\u8981\u5173\u6ce8"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Shopping"),(0,r.kt)("td",{parentName:"tr",align:null},"\u8d2d\u7269\u7684\u6574\u4e2a\u6d41\u7a0b\u62c6\u5206\u6210\u4e0d\u540c\u7684\u4e8b\u4ef6"),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Ranking"),(0,r.kt)("td",{parentName:"tr",align:null},"\u6bcf\u6b21\u7528\u6237\u4f7f\u7528\u8be5\u6570\u636e\uff08Hashtag\uff0c\u542c\u6b4c\uff09\u5219\u4ea7\u751f\u591a\u4e2a\u4e8b\u4ef6"),(0,r.kt)("td",{parentName:"tr",align:null})))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u9700\u8981\u5173\u6ce8")),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://learn.microsoft.com/en-us/azure/architecture/patterns/cqrs#implementation-issues-and-considerations"},"Issues and considerations")),(0,r.kt)("p",null,"Messaging"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"Although CQRS does not require messaging, it's common to use messaging to process commands and publish update events. In that case, the application must handle message failures or duplicate messages. See the guidance on Priority Queues for dealing with commands having different priorities.")),(0,r.kt)("p",null,"Eventual consistency"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"If you separate the read and write databases, the read data may be stale. The read model store must be updated to reflect changes to the write model store, and it can be difficult to detect when a user has issued a request based on stale read data.")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u5982\u4f55\u6267\u884c")),(0,r.kt)("p",null,"\u5177\u4f53\u7b56\u7565\u8bf7\u6d4f\u89c8\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://learn.microsoft.com/en-us/azure/architecture/patterns/cqrs#solution"},"Solution"))),(0,r.kt)("h3",{id:"gatekeeper-pattern"},(0,r.kt)("a",{parentName:"h3",href:"https://docs.microsoft.com/en-us/azure/architecture/patterns/gatekeeper"},"Gatekeeper pattern")),(0,r.kt)("p",null,"\u4f7f\u7528 Gateway \u53bb\u9a8c\u8bc1\u548c\u5904\u7406\u8bf7\u6c42\uff0c\u63d0\u9ad8\u7cfb\u7edf\u5b89\u5168\u6027"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u4f55\u65f6\u4f7f\u7528")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"\u5e94\u7528"),(0,r.kt)("th",{parentName:"tr",align:null},"\u529f\u80fd"),(0,r.kt)("th",{parentName:"tr",align:null},"\u9700\u8981\u5173\u6ce8"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Shopping"),(0,r.kt)("td",{parentName:"tr",align:null},"\u9650\u5236\u6d41\u91cf\u4ee5\u53ca\u670d\u52a1\u964d\u7ea7"),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Video"),(0,r.kt)("td",{parentName:"tr",align:null},"\u6d41\u91cf\u5206\u53d1\u4ee5\u53ca\u8d1f\u8f7d\u5747\u8861"),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Trading"),(0,r.kt)("td",{parentName:"tr",align:null},"\u6d41\u91cf\u9a8c\u8bc1\u4ee5\u53ca\u5b89\u5168\u9632\u62a4"),(0,r.kt)("td",{parentName:"tr",align:null})))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u9700\u8981\u5173\u6ce8")),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://learn.microsoft.com/en-us/azure/architecture/patterns/gatekeeper#issues-and-considerations"},"Issues and considerations")),(0,r.kt)("p",null,"Security"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"Ensure that the trusted hosts the gatekeeper passes requests to expose only internal or protected endpoints and connect only to the gatekeeper. The trusted hosts shouldn't expose any external endpoints or interfaces.")),(0,r.kt)("p",null,"Single point of failure"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"The gatekeeper instance could be a single point of failure. To minimize the impact of a failure, consider deploying additional instances and using an autoscaling mechanism to ensure capacity to maintain availability.")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u5982\u4f55\u6267\u884c")),(0,r.kt)("p",null,"\u5177\u4f53\u7b56\u7565\u8bf7\u6d4f\u89c8\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://learn.microsoft.com/en-us/azure/architecture/patterns/gatekeeper#solution"},"Solution"))),(0,r.kt)("h3",{id:"geode-pattern"},(0,r.kt)("a",{parentName:"h3",href:"https://docs.microsoft.com/en-us/azure/architecture/patterns/geodes"},"Geode pattern")),(0,r.kt)("p",null,"\u6839\u636e\u5730\u7406\u4f4d\u7f6e\u5c06\u8bf7\u6c42\u5bfc\u5411\u6700\u4f18\u7684\u670d\u52a1\u5668/\u6570\u636e\u5e93\u5904\u7406\u8bf7\u6c42\u3002"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u4f55\u65f6\u4f7f\u7528")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"\u5e94\u7528"),(0,r.kt)("th",{parentName:"tr",align:null},"\u529f\u80fd"),(0,r.kt)("th",{parentName:"tr",align:null},"\u9700\u8981\u5173\u6ce8"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Live"),(0,r.kt)("td",{parentName:"tr",align:null},"\u51cf\u5c11\u6d4f\u89c8\u76f4\u64ad\u7684\u5ef6\u8fdf\uff0c\u591a\u7ea7\u7f13\u5b58\u548c\u5927\u91cf\u91cd\u590d\u8bf7\u6c42\u5904\u7406"),(0,r.kt)("td",{parentName:"tr",align:null},"-")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Video"),(0,r.kt)("td",{parentName:"tr",align:null},"\u51cf\u5c11\u6d4f\u89c8\u76f4\u64ad\u7684\u5ef6\u8fdf\uff0c\u591a\u7ea7\u7f13\u5b58\u548c\u5927\u91cf\u91cd\u590d\u8bf7\u6c42\u5904\u7406"),(0,r.kt)("td",{parentName:"tr",align:null},"Cache")))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u9700\u8981\u5173\u6ce8")),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://learn.microsoft.com/en-us/azure/architecture/patterns/geodes#issues-and-considerations"},"Issues and considerations")),(0,r.kt)("p",null,"Log Analytics"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"Consider how to track different components of the same request as they might execute asynchronously on different instances. A proper monitoring strategy is crucial. ")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u5982\u4f55\u6267\u884c")),(0,r.kt)("p",null,"\u5177\u4f53\u7b56\u7565\u8bf7\u6d4f\u89c8\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://learn.microsoft.com/en-us/azure/architecture/patterns/geodes#solution"},"Solution"))),(0,r.kt)("h3",{id:"rate-limiting-pattern"},(0,r.kt)("a",{parentName:"h3",href:"https://docs.microsoft.com/en-us/azure/architecture/patterns/rate-limiting-pattern"},"Rate Limiting pattern")),(0,r.kt)("p",null,"\u8282\u6d41\u6a21\u5f0f\u7528\u4e8e\u51cf\u5c11\u6d41\u91cf\u4ee5\u53ca\u589e\u52a0\u5e26\u5bbd\u541e\u5410\u91cf\uff0c\u8282\u6d41\u7b56\u7565\u53ef\u4ee5\u4ece\u6bcf\u79d2\u8bf7\u6c42\u6570\uff0c\u8bf7\u6c42\u6570\u636e\u91cf\uff0c\u8d39\u7528\u7b49\u7ef4\u5ea6\u8fdb\u884c\u914d\u7f6e\u3002"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u4f55\u65f6\u4f7f\u7528")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"\u5e94\u7528"),(0,r.kt)("th",{parentName:"tr",align:null},"\u529f\u80fd"),(0,r.kt)("th",{parentName:"tr",align:null},"\u9700\u8981\u5173\u6ce8"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Live"),(0,r.kt)("td",{parentName:"tr",align:null},"\u5bf9\u6d41\u91cf\u8fdb\u884c\u9650\u5236"),(0,r.kt)("td",{parentName:"tr",align:null},"-")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Video"),(0,r.kt)("td",{parentName:"tr",align:null},"\u5bf9\u6d41\u91cf\u8fdb\u884c\u9650\u5236"),(0,r.kt)("td",{parentName:"tr",align:null},"-")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Shopping"),(0,r.kt)("td",{parentName:"tr",align:null},"\u5bf9\u6d41\u91cf\u8fdb\u884c\u9650\u5236"),(0,r.kt)("td",{parentName:"tr",align:null},"-")))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u9700\u8981\u5173\u6ce8")),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://docs.microsoft.com/en-us/azure/architecture/patterns/rate-limiting-pattern#issues-and-considerations"},"Issues and considerations")),(0,r.kt)("p",null,"Durable messaging system"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"In scenarios where your APIs can handle requests faster than any throttled ingestion services allow, you'll need to manage how quickly you can use the service. However, only treating the throttling as a data rate mismatch problem, and simply buffering your ingestion requests until the throttled service can catch up, is risky. If your application crashes in this scenario, you risk losing any of this buffered data.")),(0,r.kt)("p",null,"Improve throughput"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"While not required, it's often recommended to send smaller amounts of records more frequently to improve throughput. So rather than trying to batch things up for a release once a second or once a minute, you can be more granular than that to keep your resource consumption (memory, CPU, network, etc.) flowing at a more even rate, preventing potential bottlenecks due to sudden bursts of requests. For example, if a service allows 100 operations per second, the implementation of a rate limiter may even out requests by releasing 20 operations every 200 milliseconds, as shown in the following graph.")),(0,r.kt)("p",null,"Errors handle"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"While the rate limiting pattern can reduce the number of throttling errors, your application will still need to properly handle any throttling errors that may occur.")),(0,r.kt)("p",null,"Integrate multiple workstreams into rate limiting strategy"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"If your application has multiple workstreams that access the same throttled service, you'll need to integrate all of them into your rate limiting strategy. For instance, you might support bulk loading records into a database but also querying for records in that same database. You can manage capacity by ensuring all workstreams are gated through the same rate limiting mechanism. Alternatively, you might reserve separate pools of capacity for each workstream.")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u5982\u4f55\u6267\u884c")),(0,r.kt)("p",null,"\u5177\u4f53\u7b56\u7565\u8bf7\u6d4f\u89c8\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://docs.microsoft.com/en-us/azure/architecture/patterns/rate-limiting-pattern#issues-and-considerations"},"Solution"))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u76f8\u5173\u7ec4\u4ef6")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"\u540d\u79f0"),(0,r.kt)("th",{parentName:"tr",align:null},"\u7279\u70b9"),(0,r.kt)("th",{parentName:"tr",align:null},"\u9605\u8bfb"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Google Cloud Armor"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("ul",null,(0,r.kt)("li",null,"Adaptive protection"),(0,r.kt)("li",null,"Bot management"),(0,r.kt)("li",null,"Rate limiting"))),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://cloud.google.com/armor#section-2"},"Cloud Armor Key features"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Amazon API Gateway"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("ul",null,(0,r.kt)("li",null,"Support for RESTful APIs and WebSocket APIs"),(0,r.kt)("li",null,"API Operations Monitoring"))),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://aws.amazon.com/api-gateway/features/"},"Amazon API Gateway Features"))))),(0,r.kt)("h3",{id:"saga-distributed-transactions-pattern"},(0,r.kt)("a",{parentName:"h3",href:"https://docs.microsoft.com/en-us/azure/architecture/reference-architectures/saga/saga"},"Saga distributed transactions pattern")),(0,r.kt)("p",null,"Saga \u662f\u4e00\u79cd\u6545\u969c\u5904\u7406 pattern\uff0c\u7528\u4e8e\u5206\u5e03\u5f0f\u5e94\u7528\u7a0b\u5e8f\u4e2d\u5efa\u7acb\u4e00\u81f4\u6027\uff0c\u5e76\u534f\u8c03\u591a\u4e2a\u5fae\u670d\u52a1\u4e4b\u95f4\u7684\u4e8b\u52a1\u4ee5\u4fdd\u6301\u6570\u636e\u4e00\u81f4\u6027\u3002\u5176\u4f7f\u7528 Choreography \u548c Orchestration \u5b9e\u73b0 Compensating Transaction pattern "),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u4f55\u65f6\u4f7f\u7528")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"\u5e94\u7528"),(0,r.kt)("th",{parentName:"tr",align:null},"\u529f\u80fd"),(0,r.kt)("th",{parentName:"tr",align:null},"\u9700\u8981\u5173\u6ce8"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Uber"),(0,r.kt)("td",{parentName:"tr",align:null},"\u53eb\u8f66\u6d41\u7a0b\u4e2d\u51fa\u9519\uff08\u53eb\u5230\u8f66\u4f46\u662f\u53f8\u673a\u53d6\u6d88\uff0c\u81ea\u52a8\u91cd\u65b0\u53eb\u8f66\uff09\u8fd8\u539f\u53f8\u673a\u4ee5\u53ca\u4e58\u5ba2\u72b6\u6001"),(0,r.kt)("td",{parentName:"tr",align:null},"Retry")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"File Sync"),(0,r.kt)("td",{parentName:"tr",align:null},"\u6587\u4ef6\u540c\u6b65\u8fc7\u7a0b\u51fa\u9519\uff08\u6587\u4ef6\u5939\u540d\u88ab\u5360\u7528\uff0c\u81ea\u52a8\u4fee\u6539\uff09\uff0c\u8fd8\u539f\u6587\u4ef6\u72b6\u6001"),(0,r.kt)("td",{parentName:"tr",align:null},"Retry")))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u9700\u8981\u5173\u6ce8")),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://learn.microsoft.com/en-us/azure/architecture/reference-architectures/saga/saga#issues-and-considerations"},"Issues and considerations")),(0,r.kt)("p",null,"idempotence"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"The implementation must be capable of handling a set of potential transient failures, and provide idempotence for reducing side-effects and ensuring data consistency.")),(0,r.kt)("p",null,"Lost updates, Dirty reads"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"Lost updates, when one saga writes without reading changes made by another saga. Dirty reads, when a transaction or a saga reads updates made by a saga that has not yet completed those updates.")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u5982\u4f55\u6267\u884c")),(0,r.kt)("p",null,"Choreography"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"Choreography is a way to coordinate sagas where participants exchange events without a centralized point of control. With choreography, each local transaction publishes domain events that trigger local transactions in other services.")),(0,r.kt)("p",null,"Orchestration"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"Orchestration is a way to coordinate sagas where a centralized controller tells the saga participants what local transactions to execute. The saga orchestrator handles all the transactions and tells the participants which operation to perform based on events. The orchestrator executes saga requests, stores and interprets the states of each task, and handles failure recovery with compensating transactions.")),(0,r.kt)("p",null,"\u5177\u4f53\u7b56\u7565\u8bf7\u6d4f\u89c8\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://learn.microsoft.com/en-us/azure/architecture/reference-architectures/saga/saga#solution"},"Solution"))),(0,r.kt)("h3",{id:"sharding-pattern"},(0,r.kt)("a",{parentName:"h3",href:"https://docs.microsoft.com/en-us/azure/architecture/patterns/sharding"},"Sharding pattern")),(0,r.kt)("p",null,"\u5bf9\u6570\u636e\u5b58\u50a8\u8fdb\u884c\u6c34\u5e73\u5212\u5206\uff0c\u63d0\u9ad8\u7cfb\u7edf\u7684 scalability \u548c availability"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u4f55\u65f6\u4f7f\u7528")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"\u5e94\u7528"),(0,r.kt)("th",{parentName:"tr",align:null},"\u529f\u80fd"),(0,r.kt)("th",{parentName:"tr",align:null},"\u9700\u8981\u5173\u6ce8"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Newsfeed"),(0,r.kt)("td",{parentName:"tr",align:null},"\u5bf9 news \u8fdb\u884c sharding"),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Live"),(0,r.kt)("td",{parentName:"tr",align:null},"\u5bf9 video \u8fdb\u884c sharding"),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"search"),(0,r.kt)("td",{parentName:"tr",align:null},"\u5bf9\u67e5\u8be2\u5185\u5bb9\u8fdb\u884c sharding"),(0,r.kt)("td",{parentName:"tr",align:null})))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u9700\u8981\u5173\u6ce8")),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://learn.microsoft.com/en-us/azure/architecture/patterns/sharding#issues-and-considerations"},"Issues and considerations")),(0,r.kt)("p",null,"Rebalance"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"Rebalancing can be an expensive operation. To reduce the necessity of rebalancing, plan for growth by ensuring that each shard contains sufficient free space to handle the expected volume of changes. You should also develop strategies and scripts you can use to quickly rebalance shards if this becomes necessary.")),(0,r.kt)("p",null,"Use stable data for the shard key"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"avoid basing the shard key on potentially volatile information. Instead, look for attributes that are invariant or that naturally form a key.")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u5982\u4f55\u6267\u884c")),(0,r.kt)("p",null,"\u5177\u4f53\u7b56\u7565\u8bf7\u6d4f\u89c8\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://learn.microsoft.com/en-us/azure/architecture/patterns/sharding#solution"},"Solution")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://learn.microsoft.com/en-us/previous-versions/msp-n-p/dn589795(v=pandp.10)"},"Data Partitioning Guidance"))),(0,r.kt)("h3",{id:"valet-key-pattern"},(0,r.kt)("a",{parentName:"h3",href:"https://docs.microsoft.com/en-us/azure/architecture/patterns/valet-key"},"Valet Key pattern")),(0,r.kt)("p",null,"\u4f7f\u7528 token \u8fdb\u884c\u9274\u6743\uff0c\u4f7f\u7528\u6237\u53ef\u4ee5\u76f4\u63a5\u8bbf\u95ee\u8d44\u6e90\uff0c\u65e0\u9700\u6bcf\u6b21\u90fd\u7ecf\u8fc7\u670d\u52a1\u5668"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u4f55\u65f6\u4f7f\u7528")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"\u5e94\u7528"),(0,r.kt)("th",{parentName:"tr",align:null},"\u529f\u80fd"),(0,r.kt)("th",{parentName:"tr",align:null},"\u9700\u8981\u5173\u6ce8"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Newsfeed"),(0,r.kt)("td",{parentName:"tr",align:null},"\u4e0a\u4f20\u56fe\u7247\u548c\u89c6\u9891"),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Infrastructure"),(0,r.kt)("td",{parentName:"tr",align:null},"\u8ba4\u8bc1\u8c03\u7528\u8005\uff0c\u8bb0\u5f55 quota"),(0,r.kt)("td",{parentName:"tr",align:null})))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u9700\u8981\u5173\u6ce8")),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://learn.microsoft.com/en-us/azure/architecture/patterns/valet-key#issues-and-considerations"},"Issues and considerations")),(0,r.kt)("p",null,"Manage the validity status and period of the key."),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"A key can usually be revoked or disabled, depending on how it was issued. Server-side policies can be changed or, the server key it was signed with can be invalidated. Specify a short validity period to minimize the risk of allowing unauthorized operations to take place against the data store. However, if the validity period is too short, the client might not be able to complete the operation before the key expires.")),(0,r.kt)("p",null,"Control the level of access the key will provide"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"Typically, the key should allow the user to only perform the actions necessary to complete the operation, such as read-only access if the client shouldn't be able to upload data to the data store.")),(0,r.kt)("p",null,"Deliver the key securely"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"It can be embedded in a URL that the user activates in a web page, or it can be used in a server redirection operation so that the download occurs automatically. Always use HTTPS to deliver the key over a secure channel.")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u5982\u4f55\u6267\u884c")),(0,r.kt)("p",null,"\u5177\u4f53\u7b56\u7565\u8bf7\u6d4f\u89c8\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://learn.microsoft.com/en-us/azure/architecture/patterns/valet-key#solution"},"Solution"))),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"valet-key-pattern",src:a(8296).Z,width:"616",height:"316"})),(0,r.kt)("h2",{id:"\u901a\u7528\u8bbe\u8ba1\u6a21\u5f0f"},"\u901a\u7528\u8bbe\u8ba1\u6a21\u5f0f"),(0,r.kt)("h3",{id:"ambassador-pattern"},(0,r.kt)("a",{parentName:"h3",href:"https://docs.microsoft.com/en-us/azure/architecture/patterns/ambassador"},"Ambassador pattern")),(0,r.kt)("p",null,"\u4f7f\u7528\u4e00\u4e2a\u9002\u914d\u5668\u6765\u7ba1\u7406\u65b0\u7cfb\u7edf\u4e0e\u65e7\u7cfb\u7edf\u76f4\u63a5\u7684\u6570\u636e\u4ea4\u6362"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u9700\u8981\u5173\u6ce8")),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://learn.microsoft.com/en-us/azure/architecture/patterns/ambassador#issues-and-considerations"},"Issues and considerations")),(0,r.kt)("p",null,"Latency"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"The proxy adds some latency overhead. Consider whether a client library, invoked directly by the application, is a better approach.")),(0,r.kt)("p",null,"Idempotent"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"Consider the possible impact of including generalized features in the proxy. For example, the ambassador could handle retries, but that might not be safe unless all operations are idempotent.")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u5982\u4f55\u6267\u884c")),(0,r.kt)("p",null,"\u5177\u4f53\u7b56\u7565\u8bf7\u6d4f\u89c8\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://learn.microsoft.com/en-us/azure/architecture/patterns/ambassador#solution"},"Solution"))),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"ambassador",src:a(4349).Z,width:"733",height:"259"})),(0,r.kt)("h3",{id:"anti-corruption-layer-pattern"},(0,r.kt)("a",{parentName:"h3",href:"https://docs.microsoft.com/en-us/azure/architecture/patterns/anti-corruption-layer"},"Anti-corruption Layer pattern")),(0,r.kt)("p",null,"\u4f7f\u7528\u4e00\u4e2a\u9002\u914d\u5668\u6765\u7ba1\u7406\u65b0\u7cfb\u7edf\u4e0e\u65e7\u7cfb\u7edf\u76f4\u63a5\u7684\u6570\u636e\u4ea4\u6362"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u4f55\u65f6\u4f7f\u7528")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"\u5e94\u7528"),(0,r.kt)("th",{parentName:"tr",align:null},"\u529f\u80fd"),(0,r.kt)("th",{parentName:"tr",align:null},"\u9700\u8981\u5173\u6ce8"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Infrastructure"),(0,r.kt)("td",{parentName:"tr",align:null},"\u6846\u67b6\u8fc1\u79fb\uff0c\u65b0\u65e7\u7cfb\u7edf\u4ea4\u4e92"),(0,r.kt)("td",{parentName:"tr",align:null})))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u9700\u8981\u5173\u6ce8")),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://learn.microsoft.com/en-us/azure/architecture/patterns/anti-corruption-layer#issues-and-considerations"},"Issues and considerations")),(0,r.kt)("p",null,"Latency"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"The anti-corruption layer may add latency to calls made between the two systems.")),(0,r.kt)("p",null,"Transaction"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"Make sure transaction and data consistency are maintained and can be monitored.")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u5982\u4f55\u6267\u884c")),(0,r.kt)("p",null,"\u5177\u4f53\u7b56\u7565\u8bf7\u6d4f\u89c8\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://learn.microsoft.com/en-us/azure/architecture/patterns/anti-corruption-layer#solution"},"Solution"))),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"anti-corruption-layer",src:a(6256).Z,width:"2913",height:"1404"})),(0,r.kt)("h3",{id:"cache-aside-pattern"},(0,r.kt)("a",{parentName:"h3",href:"https://docs.microsoft.com/en-us/azure/architecture/patterns/cache-aside"},"Cache-Aside pattern")),(0,r.kt)("p",null,"\u4f7f\u7528\u7f13\u5b58\u7ec4\u4ef6\u5bf9\u6570\u636e\u8fdb\u884c\u5206\u7ea7\u5b58\u50a8\uff0c\u63d0\u9ad8\u8bfb\u53d6\u901f\u5ea6"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u4f55\u65f6\u4f7f\u7528")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"\u5e94\u7528"),(0,r.kt)("th",{parentName:"tr",align:null},"\u529f\u80fd"),(0,r.kt)("th",{parentName:"tr",align:null},"\u9700\u8981\u5173\u6ce8"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Video"),(0,r.kt)("td",{parentName:"tr",align:null},"\u4f7f\u7528 CDN \u548c POP \u7f13\u5b58\u70ed\u95e8\u89c6\u9891"),(0,r.kt)("td",{parentName:"tr",align:null},"\u70ed\u95e8\u89c6\u9891\u63d0\u524d\u9884\u70ed\uff0c\u5b9a\u65f6\u66f4\u65b0\u7f13\u5b58\u89c6\u9891")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Ranking"),(0,r.kt)("td",{parentName:"tr",align:null},"\u5bf9\u6392\u540d\u7ed3\u679c\u8fdb\u884c\u7f13\u5b58"),(0,r.kt)("td",{parentName:"tr",align:null},"\u5b9a\u671f\u8ba1\u7b97\u6392\u540d\u5e76\u4e14\u66f4\u65b0\u7f13\u5b58")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Search"),(0,r.kt)("td",{parentName:"tr",align:null},"\u5bf9\u641c\u7d22\u7ed3\u679c\u8fdb\u884c\u7f13\u5b58"),(0,r.kt)("td",{parentName:"tr",align:null},"\u5b9a\u671f\u8ba1\u7b97\u641c\u7d22\u7ed3\u679c\u5e76\u4e14\u66f4\u65b0\u7f13\u5b58")))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u9700\u8981\u5173\u6ce8")),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://docs.microsoft.com/en-us/azure/architecture/patterns/cache-aside#issues-and-considerations"},"Issues and considerations")),(0,r.kt)("p",null,"Lifetime of cached data"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"Don't make the expiration period too short because this can cause applications to continually retrieve data from the data store and add it to the cache. Similarly, don't make the expiration period so long that the cached data is likely to become stale. ")),(0,r.kt)("p",null,"Evicting data"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"Most caches adopt a least-recently-used policy for selecting items to evict, but this might be customizable.")),(0,r.kt)("p",null,"Priming the cache"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"Many solutions prepopulate the cache with the data that an application is likely to need as part of the startup processing.")),(0,r.kt)("p",null,"Consistency"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"Implementing the Cache-Aside pattern doesn't guarantee consistency between the data store and the cache.")),(0,r.kt)("p",null,"Local (in-memory) caching"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"This data could quickly become inconsistent between caches, so it might be necessary to expire data held in a private cache and refresh it more frequently. In these scenarios, consider investigating the use of a shared or a distributed caching mechanism.")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u5982\u4f55\u6267\u884c")),(0,r.kt)("p",null,"\u8bfb\u53d6\u6570\u636e\uff1a"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"\u68c0\u67e5\u7f13\u5b58\u662f\u5426\u6709\u6570\u636e\uff0c\u6709\u7684\u8bdd\u4ece\u7f13\u5b58\u8fd4\u56de"),(0,r.kt)("li",{parentName:"ol"},"\u5982\u679c\u6ca1\u6709\u7684\u8bdd\uff0c\u4ece\u6301\u4e45\u5316\u5b58\u50a8\u4e2d\u8bfb\u53d6\u6570\u636e"),(0,r.kt)("li",{parentName:"ol"},"\u5c06\u6570\u636e\u5199\u5165\u7f13\u5b58")),(0,r.kt)("p",null,"\u5199\u6570\u636e\uff1a"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"\u5c06\u6570\u636e\u5199\u5165\u6301\u4e45\u5316\u5b58\u50a8"),(0,r.kt)("li",{parentName:"ol"},"\u4ece\u7f13\u5b58\u5220\u9664\u6570\u636e")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u76f8\u5173\u7ec4\u4ef6")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"\u540d\u79f0"),(0,r.kt)("th",{parentName:"tr",align:null},"\u7279\u70b9"),(0,r.kt)("th",{parentName:"tr",align:null},"\u9605\u8bfb"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Redis"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("ul",null,(0,r.kt)("li",null,"atomic operations"),(0,r.kt)("li",null,"in-memory dataset"),(0,r.kt)("li",null,"asynchronous replication"))),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://redis.io/docs/about/"},"Introduction to Redis"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Memorystore"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("ul",null,(0,r.kt)("li",null,"supports both Redis and Memcached and is fully protocol compatible"),(0,r.kt)("li",null,"Provisioning, replication, failover, and patching are all automated"),(0,r.kt)("li",null,"Highly scalable & Highly available"))),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://cloud.google.com/memorystore"},"Memorystore"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Amazon ElastiCache"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("ul",null,(0,r.kt)("li",null,"Support for two engines: Memcached and Redis"),(0,r.kt)("li",null,"Ease of management via the AWS Management Console"),(0,r.kt)("li",null,"Detailed monitoring statistics for the engine nodes at no extra cost via Amazon CloudWatch"))),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://aws.amazon.com/elasticache/features/?nc=sn&loc=3"},"Amazon ElastiCache features"))))),(0,r.kt)("h3",{id:"health-endpoint-monitoring-pattern"},(0,r.kt)("a",{parentName:"h3",href:"https://docs.microsoft.com/en-us/azure/architecture/patterns/health-endpoint-monitoring"},"Health Endpoint Monitoring pattern")),(0,r.kt)("p",null,"\u5b9a\u65f6\u8bf7\u6c42\u670d\u52a1\u5668\u68c0\u67e5\u5176\u5065\u5eb7\u72b6\u51b5"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u4f55\u65f6\u4f7f\u7528")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"\u5e94\u7528"),(0,r.kt)("th",{parentName:"tr",align:null},"\u529f\u80fd"),(0,r.kt)("th",{parentName:"tr",align:null},"\u9700\u8981\u5173\u6ce8")))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u9700\u8981\u5173\u6ce8")),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://learn.microsoft.com/en-us/azure/architecture/patterns/health-endpoint-monitoring#issues-and-considerations"},"Issues and considerations")),(0,r.kt)("p",null,"How to validate the response. "),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"While this provides the most basic measure of application availability, and is the minimum implementation of this pattern, it provides little information about the operations, trends, and possible upcoming issues in the application.")),(0,r.kt)("p",null,"Security"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"To protect them from public access, which might expose the application to malicious attacks, risk the exposure of sensitive information, or attract denial of service (DoS) attacks. ")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u5982\u4f55\u6267\u884c")),(0,r.kt)("p",null,"\u5177\u4f53\u7b56\u7565\u8bf7\u6d4f\u89c8\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://learn.microsoft.com/en-us/azure/architecture/patterns/health-endpoint-monitoring#solution"},"Solution"))),(0,r.kt)("h3",{id:"retry-pattern--circuit-breaker-pattern"},(0,r.kt)("a",{parentName:"h3",href:"https://docs.microsoft.com/en-us/azure/architecture/patterns/retry"},"Retry pattern")," & ",(0,r.kt)("a",{parentName:"h3",href:"https://docs.microsoft.com/en-us/azure/architecture/patterns/choreography"},"Circuit Breaker pattern")),(0,r.kt)("p",null,"\u4f7f\u7528\u4ee3\u7406\u7b56\u7565\u5bf9\u91cd\u8bd5\u529f\u80fd\u8fdb\u884c\u7ba1\u7406\u548c\u9650\u5236\uff0c\u9632\u6b62\u51fa\u73b0\u5927\u91cf\u91cd\u8bd5\u5bfc\u81f4\u539f\u672c\u5d29\u6e83\u7684\u7ec4\u4ef6\u65e0\u6cd5\u6062\u590d\u4ee5\u53ca\u8017\u7528\u8fc7\u591a\u91cd\u8bd5\u8d44\u6e90\u3002"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u4f55\u65f6\u4f7f\u7528")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"\u5e94\u7528"),(0,r.kt)("th",{parentName:"tr",align:null},"\u529f\u80fd"),(0,r.kt)("th",{parentName:"tr",align:null},"\u9700\u8981\u5173\u6ce8"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"News Feed"),(0,r.kt)("td",{parentName:"tr",align:null},"\u5bf9\u6d88\u606f\u53d1\u9001\u5931\u8d25\u8fdb\u884c\u91cd\u8bd5"),(0,r.kt)("td",{parentName:"tr",align:null},"Exception Handling, Logging")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"IM"),(0,r.kt)("td",{parentName:"tr",align:null},"\u5bf9\u6d88\u606f\u53d1\u9001\u5931\u8d25\u8fdb\u884c\u91cd\u8bd5"),(0,r.kt)("td",{parentName:"tr",align:null},"Exception Handling, Logging")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"File Sync"),(0,r.kt)("td",{parentName:"tr",align:null},"\u5bf9\u4e1a\u52a1\u64cd\u4f5c\u8fdb\u884c\u91cd\u8bd5\uff08\u66f4\u65b0\u6587\u4ef6\uff09"),(0,r.kt)("td",{parentName:"tr",align:null},"Retry after delay")))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u9700\u8981\u5173\u6ce8")),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://docs.microsoft.com/en-us/azure/architecture/patterns/retry#solution"},"Retry Issues and considerations"),"\n",(0,r.kt)("a",{parentName:"p",href:"https://docs.microsoft.com/en-us/azure/architecture/patterns/circuit-breaker"},"Circuit Breaker Issues and considerations")),(0,r.kt)("p",null,"Fail fast"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"For some noncritical operations, it's better to fail fast rather than retry several times and impact the throughput of the application.")),(0,r.kt)("p",null,"Exception Handling"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"A request to a service can fail for a variety of reasons raising different exceptions depending on the nature of the failure. Some exceptions indicate a failure that can be resolved quickly, while others indicate that the failure is longer lasting. It's useful for the retry policy to adjust the time between retry attempts based on the type of the exception.")),(0,r.kt)("p",null,"Idempotent"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"retries could cause the operation to be executed more than once, with unintended side effects")),(0,r.kt)("p",null,"Logging"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"It's important to log all connectivity failures that cause a retry so that underlying problems with the application, services, or resources can be identified.")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u5982\u4f55\u6267\u884c")),(0,r.kt)("p",null,"\u5177\u4f53\u7b56\u7565\u8bf7\u6d4f\u89c8\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://docs.microsoft.com/en-us/azure/architecture/patterns/retry#solution"},"Solution")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://docs.microsoft.com/en-us/azure/architecture/patterns/circuit-breaker#solution"},"Solution"))))}m.isMDXComponent=!0},4349:(t,e,a)=>{a.d(e,{Z:()=>n});const n=a.p+"assets/images/ambassador-b3bd478013b1849e5ce1db9302990298.png"},6256:(t,e,a)=>{a.d(e,{Z:()=>n});const n=a.p+"assets/images/anti-corruption-layer-c31e4f8e34701b920da849f10e756ebc.png"},8296:(t,e,a)=>{a.d(e,{Z:()=>n});const n=a.p+"assets/images/valet-key-pattern-56d856f769fad75d513c261d8799e65c.png"}}]);