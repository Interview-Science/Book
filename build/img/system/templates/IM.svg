<?xml version="1.0" encoding="UTF-8"?>
<!-- Do not edit this file with editors other than diagrams.net -->
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="1541px" height="1915px" viewBox="-0.5 -0.5 1541 1915" content="&lt;mxfile host=&quot;app.diagrams.net&quot; modified=&quot;2022-11-14T05:02:40.633Z&quot; agent=&quot;5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.0.0 Safari/537.36&quot; etag=&quot;dhGotAk-ynf6-KoUmVjY&quot; version=&quot;20.5.3&quot; type=&quot;device&quot;&gt;&lt;diagram id=&quot;bVylV-SqW0GmoGPLOxYQ&quot; name=&quot;Page-1&quot;&gt;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&lt;/diagram&gt;&lt;/mxfile&gt;" style="background-color: rgb(255, 255, 255);"><defs/><g><rect x="0" y="0" width="500" height="200" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 484px; height: 1px; padding-top: 7px; margin-left: 9px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><p style="line-height: 0.9; font-size: 14px;"></p><div style="font-size: 14px;"><b>Functional</b></div><div style="font-size: 14px;">1. 用户间单独发送与接收消息，群组发送与接收消息</div><div style="font-size: 14px;">2. 用户状态显示，已读回执和消息撤回功能</div><div style="font-size: 14px;">3. 音视频通话</div><div style="font-size: 14px;"><br /></div><div style="font-size: 14px;"><b>Non-functional</b></div><div style="font-size: 14px;">1. Low latency：发送与接收时间要求响应时间低</div><div style="font-size: 14px;">2. Security: 用户发送与接收消息保证安全性</div>3. High Consistency: 消息需要保证有序性与一致性<div style="font-size: 14px;"><span style="background-color: initial;">2. High </span><span style="background-color: initial;">Availability: </span><span style="background-color: initial;">保证整个系统的高可用</span></div><div style="font-size: 14px;"><br style="font-size: 14px;" /></div><p style="font-size: 14px;"></p></div></div></div></foreignObject><text x="9" y="21" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px">Functional...</text></switch></g><rect x="0" y="210" width="500" height="460" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 484px; height: 1px; padding-top: 217px; margin-left: 9px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><p style="line-height: 0.9; font-size: 14px;"></p><div style=""><div style=""><div style=""><b>Capacity Estimation (Optional)</b><br /></div><div style=""><b><br /></b></div><div style=""><b>QPS</b></div><div style="font-size: 14px;">假设：</div><div style="font-size: 14px;"><span style="white-space: pre;">	</span>平均每秒发送一百万条消息</div><div style="font-size: 14px;"><span style="background-color: initial;"><span style="white-space: pre;">	</span>读写比 = 5:1</span></div><div style="font-size: 14px;">结论：</div><div style="font-size: 14px;"><span style="white-space: pre;">	</span>系统需要支撑 1,000,000 QPS</div><div style="font-size: 14px;"><span style="background-color: initial;"><span style="white-space: pre;">	</span>read QPS </span><span style="background-color: initial;">≈ 850,000</span></div><div style="font-size: 14px;"><span style="background-color: initial;"><span style="white-space: pre;">	</span>write QPS </span><span style="background-color: initial;">≈ 150,000</span><span style="background-color: initial;"> </span></div><div style="font-size: 14px;"><span style="background-color: initial;"><br /></span></div><div style="font-size: 14px;"><span style="background-color: initial;"><b>Storage</b></span></div><div style="font-size: 14px;"><span style="background-color: initial;">假设：</span></div><div style="font-size: 14px;"><span style="background-color: initial;"><span style="white-space: pre;">	</span>平均每个消息占用空间为 5 Kb（包括图文与视频）</span></div><div style="font-size: 14px;">结论：</div><div style="font-size: 14px;"><span style="white-space: pre;">	</span>每天新增消息数量约为 860 亿条<br /></div><div style="font-size: 14px;"><span style="white-space: pre;">	</span>每天新增存储约为 430 Tb<br /></div><div style="font-size: 14px;"><span style="background-color: initial;"><br /></span></div><div style=""><span style="background-color: initial;"><b>Throughout</b><br /></span></div><div style=""><span style="background-color: initial;">假设：</span></div><div style=""><span style="background-color: initial;"><span style="font-weight: bold; white-space: pre;">	</span>根据 QPS 和 Storage 的假设</span></div><div style=""><span style="background-color: initial;">结论：</span></div><div style=""><span style="background-color: initial;"><span style="white-space: pre;">	</span>上传下载带宽：一百万条消息/每秒 * 5 Kb = 5 Gb/s</span></div><div style=""><span style="background-color: initial;"><b><br /></b></span></div><div style="font-size: 14px;"><span style="background-color: initial;"> </span></div></div></div><p style="font-size: 14px;"></p></div></div></div></foreignObject><text x="9" y="231" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px">Capacity Estimation (Optional)...</text></switch></g><rect x="0" y="680" width="500" height="440" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 484px; height: 1px; padding-top: 687px; margin-left: 9px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><p style="line-height: 0.9; font-size: 14px;"></p><div style=""><div style=""><div style=""><b style="background-color: initial;">练习与总结</b></div><div style=""><b style="background-color: initial;"><br /></b></div><div style=""><b style="background-color: initial;">Key points</b><br /></div><div style=""><div>- 特定的应用协议：MQTT, AMQP, XMPP，特定的编程语言：Erlang</div><div>- 消息有序性和一致性</div><div>- 使用点对点加密与安全协议保证安全性</div></div><div><br /></div><div><div><b style="background-color: initial;">Patterns</b><br /></div><div>- <span style="background-color: initial;">Retry pattern &amp; Circuit Breaker pattern: 后端组件自动进行重试，减少前端重试次数</span></div></div><div><span style="background-color: initial;">- </span><span style="background-color: initial;">Publisher-Subscriber pattern: 加入群组相当于订阅群组的消息通知</span></div><div style=""><b><br /></b></div><div><b>Real Life Architectures</b></div><div style=""><span style="background-color: initial;">- Blog: </span><span style="background-color: initial;">Understanding WhatsApp's Architecture &amp; System Design</span></div><div>- Blog: <span style="background-color: initial;">A Complete Guide to Building A Video Chat Application</span></div><div>- Blog: <span style="background-color: initial;">企业微信的IM架构设计揭秘：消息模型、万人群等</span></div><div><br /></div><div><div><div><b>Similar applications</b></div><div>- NewsFeed：当关注用户时，类似于 IM 系统中接收该用户的消息</div><div><span style="background-color: initial;">- Video</span>：上传视频功能</div></div></div></div></div><p style="font-size: 14px;"></p></div></div></div></foreignObject><text x="9" y="701" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px">练习与总结Key points...</text></switch></g><rect x="510" y="0" width="1030" height="1120" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><path d="M 640 175 L 660 175 L 650 175 L 663.63 175" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 668.88 175 L 661.88 178.5 L 663.63 175 L 661.88 171.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><path d="M 600 215 L 600 235 L 600 230 L 600 243.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 600 248.88 L 596.5 241.88 L 600 243.63 L 603.5 241.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><ellipse cx="600" cy="175" rx="40" ry="40" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 78px; height: 1px; padding-top: 175px; margin-left: 561px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">Client</div></div></div></foreignObject><text x="600" y="179" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">Client</text></switch></g><path d="M 790 175 L 815 175 L 815 115 L 833.63 115" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 838.88 115 L 831.88 118.5 L 833.63 115 L 831.88 111.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><path d="M 790 175 L 815 175 L 815 235 L 833.63 235" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 838.88 235 L 831.88 238.5 L 833.63 235 L 831.88 231.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><rect x="670" y="145" width="120" height="60" rx="13.2" ry="13.2" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 175px; margin-left: 671px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">API Gateway</div></div></div></foreignObject><text x="730" y="179" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">API Gateway</text></switch></g><path d="M 1110 175 L 1150 175 L 1150 235 L 1173.63 235" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 1178.88 235 L 1171.88 238.5 L 1173.63 235 L 1171.88 231.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><path d="M 1110 175 L 1150 175 L 1150 115 L 1173.63 115" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 1178.88 115 L 1171.88 118.5 L 1173.63 115 L 1171.88 111.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><path d="M 1000 205 L 1020 145 L 1120 145 L 1100 205 Z" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 175px; margin-left: 1001px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">Queue</div></div></div></foreignObject><text x="1060" y="179" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">Queue</text></switch></g><rect x="520" y="390" width="1010" height="150" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 994px; height: 1px; padding-top: 397px; margin-left: 529px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><p style="line-height: 0.9; font-size: 14px;"></p><div style=""><div style=""><div style="">1. Client 通过 API Gateway 连接到 Chat Server，Chat Server 创建发送消息事件到 Queue，Work Server 订阅了发送消息事件，收到事件通知后将消息存储到 Message Database 中</div><div style="">2. 消息存储成功后返回 ACK 给 Queue，Push Server 订阅了消息存储成功事件，收到事件通知后通知长连接的 Client 有新的消息。</div><div style="font-size: 14px;"><br /></div></div></div><p style="font-size: 14px;"></p></div></div></div></foreignObject><text x="529" y="411" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px">1. Client 通过 API Gateway 连接到 Chat Server，Chat Server 创建发送消息事件到 Queue，Work Server 订阅了发送消息事件，收到事件通知后将消息存储到 Message Database 中...</text></switch></g><rect x="0" y="1130" width="500" height="470" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 491px; height: 1px; padding-top: 1137px; margin-left: 9px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><p style="line-height: 0.9; font-size: 14px;"></p><div style="font-size: 16px;"><div style=""><div style=""><b>API Design</b></div><div style=""><b><br /></b></div><div style="">method: POST</div><div style="">https://example.com/api/v1/messages/</div><div style=""><b><br /></b></div><div style="">send_message(user_id, message)</div><div style=""><span style="">	</span><span style="">	</span><span style="">	</span><span style="white-space: pre;">	</span>server = get_chat_server(user_id)</div><div style=""><span style="">	</span><span style="white-space: pre;">	</span>server.send(user_id, message)</div><div style=""><br /></div><div style=""><div>method: GET</div><div>https://example.com/api/v1/messages/?user_id=1</div><div><br /></div></div><div style=""><div>read_message(user_id, max_read_id):</div></div></div></div><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div style="font-size: 16px;"><div style=""><div style=""><div>server = get_chat_server(user_id)</div><div><span style=""></span>return server.read_from_db(user_id, max_read_id)</div></div></div></div></blockquote><div style="font-size: 16px;"><div style=""><div style=""><span style="background-color: initial;"><span style="">	</span></span></div><div style=""><br /></div><div style=""><span style="background-color: initial;"><br /></span></div><div style=""><span style="background-color: initial;"><br /></span></div><div style=""><span style="">	</span><span style="">	</span><br /></div></div></div><p style="font-size: 14px;"></p></div></div></div></foreignObject><text x="9" y="1151" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px">API Design...</text></switch></g><rect x="510" y="1130" width="1030" height="470" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 1021px; height: 1px; padding-top: 1137px; margin-left: 519px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><p style="line-height: 0.9; font-size: 14px;"></p><div style=""><div style=""><div style=""><br /></div></div></div><p style="font-size: 14px;"></p></div></div></div></foreignObject><text x="519" y="1151" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px">...</text></switch></g><rect x="520" y="20" width="128.75" height="30" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 127px; height: 1px; padding-top: 35px; margin-left: 521px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">发信息</div></div></div></foreignObject><text x="584" y="40" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="16px" text-anchor="middle" font-weight="bold">发信息</text></switch></g><path d="M 960 115 L 980 115 L 980 175 L 1003.63 175" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 1008.88 175 L 1001.88 178.5 L 1003.63 175 L 1001.88 171.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><rect x="840" y="85" width="120" height="60" rx="13.2" ry="13.2" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 115px; margin-left: 841px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">Chat Server</div></div></div></foreignObject><text x="900" y="119" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">Chat Server</text></switch></g><rect x="520" y="570" width="90" height="30" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 88px; height: 1px; padding-top: 585px; margin-left: 521px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">接收信息</div></div></div></foreignObject><text x="565" y="590" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="16px" text-anchor="middle" font-weight="bold">接收信息</text></switch></g><rect x="520" y="960" width="1010" height="120" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 994px; height: 1px; padding-top: 967px; margin-left: 529px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><p style="line-height: 0.9; font-size: 14px;"></p><div style=""><div style=""><div style="">1. Client 通过 Local Database 可以读取本地的聊天记录，当 Push Server 通知有新消息之后，通过 API Gateway 连接到 Chat Server（如果 Client</div><div style=""><span style="background-color: initial;"> 是在线状态的话，会一直连接 Chat Server）Chat Server 创建接收消息事件到 Queue，Work Server 订阅了接收消息事件，从 Message Database 中读取对应的消息给客户端，并且更新对应消息的已读状态。</span></div><div style=""><span style="background-color: initial;">2. 消息读取成功后返回 ACK 给 Queue，Push Server 订阅了读取成功事件，收到事件通知后更新长连接的 Client 对应消息的状态</span></div></div></div><p style="font-size: 14px;"></p></div></div></div></foreignObject><text x="529" y="981" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px">1. Client 通过 Local Database 可以读取本地的聊天记录，当 Push Server 通知有新消息之后，通过 API Gateway 连接到 Chat Server（如果 Client...</text></switch></g><path d="M 530 1320 L 530 1290 L 1520 1290 L 1520 1320" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><path d="M 530 1320 L 530 1420 L 1520 1420 L 1520 1320" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 530 1320 L 1520 1320" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 750 1320 L 750 1350 L 750 1380 L 750 1410" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><g fill="rgb(0, 0, 0)" font-family="Helvetica" font-weight="bold" pointer-events="none" text-anchor="middle" font-size="14px"><text x="1024.5" y="1310.5">Group (NoSQL)</text></g><path d="M 530 1320 M 750 1320 M 750 1350 M 530 1350" fill="none" stroke="rgb(0, 0, 0)" stroke-linecap="square" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 218px; height: 1px; padding-top: 1335px; margin-left: 531px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center; max-height: 26px; overflow: hidden;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">group_id</div></div></div></foreignObject><text x="640" y="1339" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">group_id</text></switch></g><path d="M 750 1320 M 1520 1320 M 1520 1350 M 750 1350" fill="none" stroke="rgb(0, 0, 0)" stroke-linecap="square" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 762px; height: 1px; padding-top: 1335px; margin-left: 758px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left; max-height: 26px; overflow: hidden;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">name, type, profile, etc.</div></div></div></foreignObject><text x="758" y="1339" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px">name, type, profile, etc.</text></switch></g><path d="M 530 1350 M 750 1350 M 750 1380 M 530 1380" fill="none" stroke="rgb(0, 0, 0)" stroke-linecap="square" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 218px; height: 1px; padding-top: 1365px; margin-left: 531px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center; max-height: 26px; overflow: hidden;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">group_id</div></div></div></foreignObject><text x="640" y="1369" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">group_id</text></switch></g><path d="M 750 1350 M 1520 1350 M 1520 1380 M 750 1380" fill="none" stroke="rgb(0, 0, 0)" stroke-linecap="square" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 762px; height: 1px; padding-top: 1365px; margin-left: 758px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left; max-height: 26px; overflow: hidden;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">name, type, profile, etc.</div></div></div></foreignObject><text x="758" y="1369" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px">name, type, profile, etc.</text></switch></g><path d="M 530 1380 M 750 1380 M 750 1410 M 530 1410" fill="none" stroke="rgb(0, 0, 0)" stroke-linecap="square" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 218px; height: 1px; padding-top: 1395px; margin-left: 531px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center; max-height: 26px; overflow: hidden;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">group_id</div></div></div></foreignObject><text x="640" y="1399" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">group_id</text></switch></g><path d="M 750 1380 M 1520 1380 M 1520 1410 M 750 1410" fill="none" stroke="rgb(0, 0, 0)" stroke-linecap="square" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 762px; height: 1px; padding-top: 1395px; margin-left: 758px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left; max-height: 26px; overflow: hidden;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">name, type, profile, etc.</div></div></div></foreignObject><text x="758" y="1399" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px">name, type, profile, etc.</text></switch></g><path d="M 1370 85 C 1370 76.72 1394.62 70 1425 70 C 1439.59 70 1453.58 71.58 1463.89 74.39 C 1474.21 77.21 1480 81.02 1480 85 L 1480 145 C 1480 153.28 1455.38 160 1425 160 C 1394.62 160 1370 153.28 1370 145 Z" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 1480 85 C 1480 93.28 1455.38 100 1425 100 C 1394.62 100 1370 93.28 1370 85" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 128px; margin-left: 1371px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">Message Database</div></div></div></foreignObject><text x="1425" y="132" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">Message Database</text></switch></g><rect x="0" y="1610" width="1540" height="280" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 1531px; height: 1px; padding-top: 1617px; margin-left: 9px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;"><p style="line-height: 0.9; font-size: 14px;"></p><div style=""><div style=""><div style=""><font style="font-size: 14px;"><b>  </b></font><b style="background-color: initial;">Explain</b></div><div style=""><b style="background-color: initial;"><br /></b></div><div style=""><b style="background-color: initial;">  </b><span style="background-color: initial;">1. 如何保证消息的有序性以及一致性</span></div><div style=""><span style="background-color: initial;">      这部分细节太多，请浏览：</span><span style="background-color: initial;">https://juejin.cn/post/6986554737042669576</span></div><div style=""><br /></div><div style=""><span style="background-color: initial;">  2. Client 与 Server 建立长链接具体使用什么应用协议？</span></div><div style=""><span style="background-color: initial;">      Whatsapp 基于 XMPP 协议进行高度定制， Discord 使用的是 WebSocket（具体信息：</span><span style="background-color: initial;">https://discord.com/blog/how-discord-scaled-elixir-to-5-000-000-concurrent-users），音视频通话使用 WebRTC（</span><span style="background-color: initial;">https://discord.com/blog/how-discord-handles-two-and-half-million-concurrent-voice-users-using-webrtc）</span></div><div style=""><span style="background-color: initial;">  </span></div><div style=""><span style="background-color: initial;">  3. </span><span style="background-color: initial;">不同的协议之间有什么区别？</span></div><div style=""><span style="background-color: initial;">      请浏览：</span><span style="background-color: initial;">https://www.cometchat.com/blog/popular-chat-and-instant-messaging-protocols</span></div><div style=""><span style="background-color: initial;"><br /></span></div><div style=""><span style="background-color: initial;">  4. 为什么选择 NoSQL 数据库而不是 SQL 数据库</span></div><div style=""><span style="background-color: initial;">      两者皆可，Slack 使用了 MySQL 而 Discord 使用 C</span><span style="background-color: initial;">assandra（具体信息：</span><span style="background-color: initial;">https://discord.com/blog/how-discord-stores-billions-of-messages）</span><span style="background-color: initial;">，两者各有利弊</span><span style="background-color: initial;"> </span></div><div style=""><span style="background-color: initial;">      </span></div><div><span style="background-color: initial;"><br /></span></div></div></div><p style="font-size: 14px;"></p></div></div></div></foreignObject><text x="9" y="1631" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px">Explain...</text></switch></g><path d="M 960 235 L 980 235 L 980 175 L 1003.63 175" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 1008.88 175 L 1001.88 178.5 L 1003.63 175 L 1001.88 171.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><rect x="840" y="205" width="120" height="60" rx="13.2" ry="13.2" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 235px; margin-left: 841px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">Chat Server</div></div></div></foreignObject><text x="900" y="239" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">Chat Server</text></switch></g><rect x="1180" y="205" width="120" height="60" rx="13.2" ry="13.2" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 235px; margin-left: 1181px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">Push Server</div></div></div></foreignObject><text x="1240" y="239" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">Push Server</text></switch></g><path d="M 1300 115 L 1363.63 115" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 1368.88 115 L 1361.88 118.5 L 1363.63 115 L 1361.88 111.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><rect x="1180" y="85" width="120" height="60" rx="13.2" ry="13.2" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 115px; margin-left: 1181px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">Work Server</div></div></div></foreignObject><text x="1240" y="119" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">Work Server</text></switch></g><path d="M 551.11 265 C 551.11 256.72 573 250 600 250 C 612.97 250 625.4 251.58 634.57 254.39 C 643.74 257.21 648.89 261.02 648.89 265 L 648.89 315 C 648.89 318.98 643.74 322.79 634.57 325.61 C 625.4 328.42 612.97 330 600 330 C 573 330 551.11 323.28 551.11 315 Z" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 648.89 265 C 648.89 268.98 643.74 272.79 634.57 275.61 C 625.4 278.42 612.97 280 600 280 C 573 280 551.11 273.28 551.11 265" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 96px; height: 1px; padding-top: 303px; margin-left: 552px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">Local<br />Database</div></div></div></foreignObject><text x="600" y="307" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">Local...</text></switch></g><path d="M 628.89 735 L 649 735 L 639 735 L 652.52 735" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 657.77 735 L 650.77 738.5 L 652.52 735 L 650.77 731.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 588.89 775 L 589 795 L 589 790 L 589 803.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 589 808.88 L 585.5 801.88 L 589 803.63 L 592.5 801.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><ellipse cx="588.89" cy="735" rx="40" ry="40" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 78px; height: 1px; padding-top: 735px; margin-left: 550px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">Client</div></div></div></foreignObject><text x="589" y="739" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">Client</text></switch></g><path d="M 778.89 735 L 804 735 L 804 675 L 822.52 675" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 827.77 675 L 820.77 678.5 L 822.52 675 L 820.77 671.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 778.89 735 L 804 735 L 804 795 L 822.52 795" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 827.77 795 L 820.77 798.5 L 822.52 795 L 820.77 791.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><rect x="658.89" y="705" width="120" height="60" rx="13.2" ry="13.2" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 735px; margin-left: 660px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">API Gateway</div></div></div></foreignObject><text x="719" y="739" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">API Gateway</text></switch></g><path d="M 1110 735 L 1150 735 L 1150 795 L 1173.63 795" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 1178.88 795 L 1171.88 798.5 L 1173.63 795 L 1171.88 791.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 1110 735 L 1150 735 L 1150 675 L 1173.63 675" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 1178.88 675 L 1171.88 678.5 L 1173.63 675 L 1171.88 671.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 1000 765 L 1020 705 L 1120 705 L 1100 765 Z" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 735px; margin-left: 1001px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">Queue</div></div></div></foreignObject><text x="1060" y="739" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">Queue</text></switch></g><path d="M 948.89 675 L 974.4 675 L 974.4 735 L 1003.63 735" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 1008.88 735 L 1001.88 738.5 L 1003.63 735 L 1001.88 731.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><rect x="828.89" y="645" width="120" height="60" rx="13.2" ry="13.2" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 675px; margin-left: 830px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">Chat Server</div></div></div></foreignObject><text x="889" y="679" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">Chat Server</text></switch></g><path d="M 1358.89 645 C 1358.89 636.72 1383.51 630 1413.89 630 C 1428.48 630 1442.47 631.58 1452.78 634.39 C 1463.1 637.21 1468.89 641.02 1468.89 645 L 1468.89 705 C 1468.89 713.28 1444.27 720 1413.89 720 C 1383.51 720 1358.89 713.28 1358.89 705 Z" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 1468.89 645 C 1468.89 653.28 1444.27 660 1413.89 660 C 1383.51 660 1358.89 653.28 1358.89 645" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 688px; margin-left: 1360px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">Message Database</div></div></div></foreignObject><text x="1414" y="692" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">Message Database</text></switch></g><path d="M 948.89 795 L 974.4 795 L 974.4 735 L 1003.63 735" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 1008.88 735 L 1001.88 738.5 L 1003.63 735 L 1001.88 731.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><rect x="828.89" y="765" width="120" height="60" rx="13.2" ry="13.2" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 795px; margin-left: 830px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">Chat Server</div></div></div></foreignObject><text x="889" y="799" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">Chat Server</text></switch></g><rect x="1180" y="765" width="120" height="60" rx="13.2" ry="13.2" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 795px; margin-left: 1181px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">Push Server</div></div></div></foreignObject><text x="1240" y="799" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">Push Server</text></switch></g><path d="M 1300 675 L 1352.52 675" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 1357.77 675 L 1350.77 678.5 L 1352.52 675 L 1350.77 671.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><rect x="1180" y="645" width="120" height="60" rx="13.2" ry="13.2" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 675px; margin-left: 1181px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">Work Server</div></div></div></foreignObject><text x="1240" y="679" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">Work Server</text></switch></g><path d="M 540 825 C 540 816.72 561.89 810 588.89 810 C 601.86 810 614.29 811.58 623.46 814.39 C 632.63 817.21 637.78 821.02 637.78 825 L 637.78 875 C 637.78 878.98 632.63 882.79 623.46 885.61 C 614.29 888.42 601.86 890 588.89 890 C 561.89 890 540 883.28 540 875 Z" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 637.78 825 C 637.78 828.98 632.63 832.79 623.46 835.61 C 614.29 838.42 601.86 840 588.89 840 C 561.89 840 540 833.28 540 825" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 96px; height: 1px; padding-top: 863px; margin-left: 541px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">Local<br />Database</div></div></div></foreignObject><text x="589" y="867" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">Local...</text></switch></g><path d="M 658.89 640 L 589 640 L 588.9 688.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 588.89 693.88 L 585.41 686.88 L 588.9 688.63 L 592.41 686.89 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><rect x="658.89" y="610" width="120" height="60" rx="13.2" ry="13.2" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 640px; margin-left: 660px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">Push Server</div></div></div></foreignObject><text x="719" y="644" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">Push Server</text></switch></g><path d="M 530 1180 L 530 1150 L 1520 1150 L 1520 1180" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 530 1180 L 530 1280 L 1520 1280 L 1520 1180" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 530 1180 L 1520 1180" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 750 1180 L 750 1210 L 750 1240 L 750 1270" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><g fill="rgb(0, 0, 0)" font-family="Helvetica" font-weight="bold" pointer-events="none" text-anchor="middle" font-size="14px"><text x="1024.5" y="1170.5">User (NoSQL)</text></g><path d="M 530 1180 M 750 1180 M 750 1210 M 530 1210" fill="none" stroke="rgb(0, 0, 0)" stroke-linecap="square" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 218px; height: 1px; padding-top: 1195px; margin-left: 531px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center; max-height: 26px; overflow: hidden;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">user_id</div></div></div></foreignObject><text x="640" y="1199" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">user_id</text></switch></g><path d="M 750 1180 M 1520 1180 M 1520 1210 M 750 1210" fill="none" stroke="rgb(0, 0, 0)" stroke-linecap="square" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 762px; height: 1px; padding-top: 1195px; margin-left: 758px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left; max-height: 26px; overflow: hidden;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;"> name, gender, profile, etc.</div></div></div></foreignObject><text x="758" y="1199" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px"> name, gender, profile, etc.</text></switch></g><path d="M 530 1210 M 750 1210 M 750 1240 M 530 1240" fill="none" stroke="rgb(0, 0, 0)" stroke-linecap="square" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 218px; height: 1px; padding-top: 1225px; margin-left: 531px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center; max-height: 26px; overflow: hidden;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">user_id</div></div></div></foreignObject><text x="640" y="1229" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">user_id</text></switch></g><path d="M 750 1210 M 1520 1210 M 1520 1240 M 750 1240" fill="none" stroke="rgb(0, 0, 0)" stroke-linecap="square" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 762px; height: 1px; padding-top: 1225px; margin-left: 758px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left; max-height: 26px; overflow: hidden;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;"> name, gender, profile, etc.</div></div></div></foreignObject><text x="758" y="1229" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px"> name, gender, profile, etc.</text></switch></g><path d="M 530 1240 M 750 1240 M 750 1270 M 530 1270" fill="none" stroke="rgb(0, 0, 0)" stroke-linecap="square" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 218px; height: 1px; padding-top: 1255px; margin-left: 531px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center; max-height: 26px; overflow: hidden;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">user_id</div></div></div></foreignObject><text x="640" y="1259" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">user_id</text></switch></g><path d="M 750 1240 M 1520 1240 M 1520 1270 M 750 1270" fill="none" stroke="rgb(0, 0, 0)" stroke-linecap="square" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 762px; height: 1px; padding-top: 1255px; margin-left: 758px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left; max-height: 26px; overflow: hidden;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;"> name, gender, profile, etc.</div></div></div></foreignObject><text x="758" y="1259" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px"> name, gender, profile, etc.</text></switch></g><path d="M 530 1460 L 530 1430 L 1520 1430 L 1520 1460" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 530 1460 L 530 1560 L 1520 1560 L 1520 1460" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 530 1460 L 1520 1460" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 750 1460 L 750 1490 L 750 1520 L 750 1550" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><g fill="rgb(0, 0, 0)" font-family="Helvetica" font-weight="bold" pointer-events="none" text-anchor="middle" font-size="14px"><text x="1024.5" y="1450.5">Message (NoSQL)</text></g><path d="M 530 1460 M 750 1460 M 750 1490 M 530 1490" fill="none" stroke="rgb(0, 0, 0)" stroke-linecap="square" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 218px; height: 1px; padding-top: 1475px; margin-left: 531px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center; max-height: 26px; overflow: hidden;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">message_id</div></div></div></foreignObject><text x="640" y="1479" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">message_id</text></switch></g><path d="M 750 1460 M 1520 1460 M 1520 1490 M 750 1490" fill="none" stroke="rgb(0, 0, 0)" stroke-linecap="square" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 762px; height: 1px; padding-top: 1475px; margin-left: 758px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left; max-height: 26px; overflow: hidden;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">group_id, sender_id, receiver_id, content</div></div></div></foreignObject><text x="758" y="1479" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px">group_id, sender_id, receiver_id, content</text></switch></g><path d="M 530 1490 M 750 1490 M 750 1520 M 530 1520" fill="none" stroke="rgb(0, 0, 0)" stroke-linecap="square" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 218px; height: 1px; padding-top: 1505px; margin-left: 531px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center; max-height: 26px; overflow: hidden;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">message_id</div></div></div></foreignObject><text x="640" y="1509" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">message_id</text></switch></g><path d="M 750 1490 M 1520 1490 M 1520 1520 M 750 1520" fill="none" stroke="rgb(0, 0, 0)" stroke-linecap="square" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 762px; height: 1px; padding-top: 1505px; margin-left: 758px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left; max-height: 26px; overflow: hidden;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">group_id, sender_id, receiver_id, content</div></div></div></foreignObject><text x="758" y="1509" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px">group_id, sender_id, receiver_id, content</text></switch></g><path d="M 530 1520 M 750 1520 M 750 1550 M 530 1550" fill="none" stroke="rgb(0, 0, 0)" stroke-linecap="square" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 218px; height: 1px; padding-top: 1535px; margin-left: 531px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center; max-height: 26px; overflow: hidden;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">message_id</div></div></div></foreignObject><text x="640" y="1539" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">message_id</text></switch></g><path d="M 750 1520 M 1520 1520 M 1520 1550 M 750 1550" fill="none" stroke="rgb(0, 0, 0)" stroke-linecap="square" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 762px; height: 1px; padding-top: 1535px; margin-left: 758px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left; max-height: 26px; overflow: hidden;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">group_id, sender_id, receiver_id, content</div></div></div></foreignObject><text x="758" y="1539" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px">group_id, sender_id, receiver_id, content</text></switch></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://www.diagrams.net/doc/faq/svg-export-text-problems" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Text is not SVG - cannot display</text></a></switch></svg>