<!doctype html>
<html lang="en-GB" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-系统设计/设计模式" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">设计模式 | Interview Science</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://interview-science.org/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://interview-science.org/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://interview-science.org/系统设计/设计模式"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="设计模式 | Interview Science"><meta data-rh="true" name="description" content="特定设计模式"><meta data-rh="true" property="og:description" content="特定设计模式"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://interview-science.org/系统设计/设计模式"><link data-rh="true" rel="alternate" href="https://interview-science.org/系统设计/设计模式" hreflang="en-GB"><link data-rh="true" rel="alternate" href="https://interview-science.org/zh-CN/系统设计/设计模式" hreflang="zh-CN"><link data-rh="true" rel="alternate" href="https://interview-science.org/系统设计/设计模式" hreflang="x-default"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-1QX01NQWWG"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-1QX01NQWWG",{})</script><link rel="stylesheet" href="/assets/css/styles.1042a912.css">
<link rel="preload" href="/assets/js/runtime~main.3e011891.js" as="script">
<link rel="preload" href="/assets/js/main.1a592133.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Interview Science" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.svg" alt="Interview Science" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Interview Science</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/">Doc</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/系统设计/设计模式" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en-GB">English</a></li><li><a href="/zh-CN/系统设计/设计模式" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh-CN">中文（中国）</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a href="https://github.com/Interview-Science" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">📖 前言</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/前期准备/何为面试">前期准备</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/求职阶段/寻找岗位">求职阶段</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/算法指南/学习范围">算法指南</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/系统设计/如何练习">系统设计</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/系统设计/如何练习">如何练习</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/系统设计/学习导图">学习导图</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/系统设计/应用分类">应用分类</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/系统设计/应用模式">应用与设计模式</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/系统设计/设计模式与常见问题">设计模式与常见问题</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/系统设计/应用实践">应用实践</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/系统设计/基础组件">基本组件</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/系统设计/设计模式">设计模式</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/系统设计/分类总结/信息流系统">分类总结</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/机器学习/推荐阅读">机器学习（撰写中）</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/常规内容/自我介绍">常规内容</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/非技术问题/概述">非技术问题</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">系统设计</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">设计模式</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>设计模式</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="特定设计模式">特定设计模式<a href="#特定设计模式" class="hash-link" aria-label="Direct link to 特定设计模式" title="Direct link to 特定设计模式">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="asynchronous-request-reply-pattern"><a href="https://docs.microsoft.com/en-us/azure/architecture/patterns/async-request-reply" target="_blank" rel="noopener noreferrer">Asynchronous Request-Reply Pattern</a><a href="#asynchronous-request-reply-pattern" class="hash-link" aria-label="Direct link to asynchronous-request-reply-pattern" title="Direct link to asynchronous-request-reply-pattern">​</a></h3><p>服务端马上返回客户端请求，并且异步处理任务，客户端可以稍后查询任务状态</p><p><strong>何时使用</strong></p><table><thead><tr><th>应用</th><th>功能</th><th>需要关注</th></tr></thead><tbody><tr><td>CPU-bound</td><td>查询任务状态</td><td></td></tr></tbody></table><p><strong>需要关注</strong></p><p><a href="https://learn.microsoft.com/en-us/azure/architecture/patterns/async-request-reply#issues-and-considerations" target="_blank" rel="noopener noreferrer">Issues and considerations</a></p><p>HTTP status code</p><blockquote><p>There are a number of possible ways to implement this pattern over HTTP and not all upstream services have the same semantics. For example, most services won&#x27;t return an HTTP 202 response back from a GET method when a remote process hasn&#x27;t finished. Following pure REST semantics, they should return HTTP 404 (Not Found). This response makes sense when you consider the result of the call isn&#x27;t present yet.</p></blockquote><p>Perform long-running tasks with the webhook action pattern</p><blockquote><p>Legacy clients might not support this pattern. In that case, you might need to place a facade over the asynchronous API to hide the asynchronous processing from the original client. For example, Azure Logic Apps supports this pattern natively can be used as an integration layer between an asynchronous API and a client that makes synchronous calls. See Perform long-running tasks with the webhook action pattern.</p></blockquote><p><strong>如何执行</strong></p><p>具体策略请浏览：</p><ul><li><a href="https://learn.microsoft.com/en-us/azure/architecture/patterns/async-request-reply#solution" target="_blank" rel="noopener noreferrer">Solution</a></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="compensating-transaction-pattern"><a href="https://docs.microsoft.com/en-us/azure/architecture/patterns/compensating-transaction" target="_blank" rel="noopener noreferrer">Compensating Transaction pattern</a><a href="#compensating-transaction-pattern" class="hash-link" aria-label="Direct link to compensating-transaction-pattern" title="Direct link to compensating-transaction-pattern">​</a></h3><p>使用事务补偿的方式使多步骤的事务保持最终一致性</p><p><strong>何时使用</strong></p><table><thead><tr><th>应用</th><th>功能</th><th>需要关注</th></tr></thead><tbody><tr><td>Uber</td><td>叫车流程中出错（叫到车但是司机取消，自动重新叫车）还原司机以及乘客状态</td><td>Retry</td></tr><tr><td>File Sync</td><td>文件同步过程出错（文件夹名被占用，自动修改），还原文件状态</td><td>Retry</td></tr></tbody></table><p><strong>需要关注</strong></p><p><a href="https://docs.microsoft.com/en-us/azure/architecture/patterns/compensating-transaction#issues-and-considerations" target="_blank" rel="noopener noreferrer">Issues and considerations</a></p><p>Order</p><blockquote><p>The order of the steps in the compensating transaction doesn&#x27;t necessarily have to be the exact opposite of the steps in the original operation. For example, one data store might be more sensitive to inconsistencies than another, and so the steps in the compensating transaction that undo the changes to this store should occur first.</p></blockquote><p>Fail </p><blockquote><p>A compensating transaction is also an eventually consistent operation and it could also fail. The system should be able to resume the compensating transaction at the point of failure and continue. It might be necessary to repeat a step that&#x27;s failed, so the steps in a compensating transaction should be defined as idempotent commands. </p></blockquote><p>Retry logic</p><blockquote><p>Only stop the operation and initiate a compensating transaction if a step fails repeatedly or cannot be recovered.</p></blockquote><p><strong>如何执行</strong></p><p>具体策略请浏览：</p><ul><li><a href="https://docs.microsoft.com/en-us/azure/architecture/patterns/compensating-transaction#solution" target="_blank" rel="noopener noreferrer">Solution</a></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="competing-consumers-pattern"><a href="https://docs.microsoft.com/en-us/azure/architecture/patterns/competing-consumers" target="_blank" rel="noopener noreferrer">Competing Consumers pattern</a><a href="#competing-consumers-pattern" class="hash-link" aria-label="Direct link to competing-consumers-pattern" title="Direct link to competing-consumers-pattern">​</a></h3><ul><li><a href="https://docs.microsoft.com/en-us/azure/architecture/patterns/publisher-subscriber" target="_blank" rel="noopener noreferrer">Publisher-Subscriber pattern</a></li><li><a href="https://docs.microsoft.com/en-us/azure/architecture/patterns/priority-queue" target="_blank" rel="noopener noreferrer">Priority Queue pattern</a></li><li><a href="https://docs.microsoft.com/en-us/azure/architecture/patterns/queue-based-load-leveling" target="_blank" rel="noopener noreferrer">Queue-Based Load Leveling pattern</a></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="event-sourcing-pattern"><a href="https://docs.microsoft.com/en-us/azure/architecture/patterns/event-sourcing" target="_blank" rel="noopener noreferrer">Event Sourcing pattern</a><a href="#event-sourcing-pattern" class="hash-link" aria-label="Direct link to event-sourcing-pattern" title="Direct link to event-sourcing-pattern">​</a></h3><p>使用 append-only 的方式来记录所有数据的变化，方便进行数据溯源以及保证了数据的一致性，也能提供事务补偿功能。</p><p><strong>何时使用</strong></p><table><thead><tr><th>应用</th><th>功能</th><th>需要关注</th></tr></thead><tbody><tr><td>Shopping</td><td>购物的整个流程拆分成不同的事件</td><td></td></tr><tr><td>Ranking</td><td>每次用户使用该数据（Hashtag，听歌）则产生多个事件</td><td></td></tr></tbody></table><p><strong>需要关注</strong></p><p><a href="https://learn.microsoft.com/en-us/azure/architecture/patterns/event-sourcing#issues-and-considerations" target="_blank" rel="noopener noreferrer">Issues and considerations</a></p><p>Eventually consistent</p><blockquote><p>The system will only be eventually consistent when creating materialized views or generating projections of data by replaying events. There&#x27;s some delay between an application adding events to the event store as the result of handling a request, the events being published, and consumers of the events handling them. During this period, new events that describe further changes to entities might have arrived at the event store.</p></blockquote><p>Difficult to update</p><blockquote><p>If the format (rather than the data) of the persisted events needs to change, perhaps during a migration, it can be difficult to combine existing events in the store with the new version.</p></blockquote><p>Idempotent</p><blockquote><p>Event publication might be at least once, and so consumers of the events must be idempotent. </p></blockquote><p><strong>如何执行</strong></p><p>具体策略请浏览：</p><ul><li><a href="https://learn.microsoft.com/en-us/azure/architecture/patterns/event-sourcing#solution" target="_blank" rel="noopener noreferrer">Solution</a></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="cqrs-pattern"><a href="https://docs.microsoft.com/en-us/azure/architecture/patterns/cqrs" target="_blank" rel="noopener noreferrer">CQRS pattern</a><a href="#cqrs-pattern" class="hash-link" aria-label="Direct link to cqrs-pattern" title="Direct link to cqrs-pattern">​</a></h3><p>分开读和写的操作以及存储，通常和 Event Sourcing pattern 与 Materialized View pattern 一起使用</p><p><strong>何时使用</strong></p><table><thead><tr><th>应用</th><th>功能</th><th>需要关注</th></tr></thead><tbody><tr><td>Shopping</td><td>购物的整个流程拆分成不同的事件</td><td></td></tr><tr><td>Ranking</td><td>每次用户使用该数据（Hashtag，听歌）则产生多个事件</td><td></td></tr></tbody></table><p><strong>需要关注</strong></p><p><a href="https://learn.microsoft.com/en-us/azure/architecture/patterns/cqrs#implementation-issues-and-considerations" target="_blank" rel="noopener noreferrer">Issues and considerations</a></p><p>Messaging</p><blockquote><p>Although CQRS does not require messaging, it&#x27;s common to use messaging to process commands and publish update events. In that case, the application must handle message failures or duplicate messages. See the guidance on Priority Queues for dealing with commands having different priorities.</p></blockquote><p>Eventual consistency</p><blockquote><p>If you separate the read and write databases, the read data may be stale. The read model store must be updated to reflect changes to the write model store, and it can be difficult to detect when a user has issued a request based on stale read data.</p></blockquote><p><strong>如何执行</strong></p><p>具体策略请浏览：</p><ul><li><a href="https://learn.microsoft.com/en-us/azure/architecture/patterns/cqrs#solution" target="_blank" rel="noopener noreferrer">Solution</a></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="gatekeeper-pattern"><a href="https://docs.microsoft.com/en-us/azure/architecture/patterns/gatekeeper" target="_blank" rel="noopener noreferrer">Gatekeeper pattern</a><a href="#gatekeeper-pattern" class="hash-link" aria-label="Direct link to gatekeeper-pattern" title="Direct link to gatekeeper-pattern">​</a></h3><p>使用 Gateway 去验证和处理请求，提高系统安全性</p><p><strong>何时使用</strong></p><table><thead><tr><th>应用</th><th>功能</th><th>需要关注</th></tr></thead><tbody><tr><td>Shopping</td><td>限制流量以及服务降级</td><td></td></tr><tr><td>Video</td><td>流量分发以及负载均衡</td><td></td></tr><tr><td>Trading</td><td>流量验证以及安全防护</td><td></td></tr></tbody></table><p><strong>需要关注</strong></p><p><a href="https://learn.microsoft.com/en-us/azure/architecture/patterns/gatekeeper#issues-and-considerations" target="_blank" rel="noopener noreferrer">Issues and considerations</a></p><p>Security</p><blockquote><p>Ensure that the trusted hosts the gatekeeper passes requests to expose only internal or protected endpoints and connect only to the gatekeeper. The trusted hosts shouldn&#x27;t expose any external endpoints or interfaces.</p></blockquote><p>Single point of failure</p><blockquote><p>The gatekeeper instance could be a single point of failure. To minimize the impact of a failure, consider deploying additional instances and using an autoscaling mechanism to ensure capacity to maintain availability.</p></blockquote><p><strong>如何执行</strong></p><p>具体策略请浏览：</p><ul><li><a href="https://learn.microsoft.com/en-us/azure/architecture/patterns/gatekeeper#solution" target="_blank" rel="noopener noreferrer">Solution</a></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="geode-pattern"><a href="https://docs.microsoft.com/en-us/azure/architecture/patterns/geodes" target="_blank" rel="noopener noreferrer">Geode pattern</a><a href="#geode-pattern" class="hash-link" aria-label="Direct link to geode-pattern" title="Direct link to geode-pattern">​</a></h3><p>根据地理位置将请求导向最优的服务器/数据库处理请求。</p><p><strong>何时使用</strong></p><table><thead><tr><th>应用</th><th>功能</th><th>需要关注</th></tr></thead><tbody><tr><td>Live</td><td>减少浏览直播的延迟，多级缓存和大量重复请求处理</td><td>-</td></tr><tr><td>Video</td><td>减少浏览直播的延迟，多级缓存和大量重复请求处理</td><td>Cache</td></tr></tbody></table><p><strong>需要关注</strong></p><p><a href="https://learn.microsoft.com/en-us/azure/architecture/patterns/geodes#issues-and-considerations" target="_blank" rel="noopener noreferrer">Issues and considerations</a></p><p>Log Analytics</p><blockquote><p>Consider how to track different components of the same request as they might execute asynchronously on different instances. A proper monitoring strategy is crucial. </p></blockquote><p><strong>如何执行</strong></p><p>具体策略请浏览：</p><ul><li><a href="https://learn.microsoft.com/en-us/azure/architecture/patterns/geodes#solution" target="_blank" rel="noopener noreferrer">Solution</a></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="rate-limiting-pattern"><a href="https://docs.microsoft.com/en-us/azure/architecture/patterns/rate-limiting-pattern" target="_blank" rel="noopener noreferrer">Rate Limiting pattern</a><a href="#rate-limiting-pattern" class="hash-link" aria-label="Direct link to rate-limiting-pattern" title="Direct link to rate-limiting-pattern">​</a></h3><p>节流模式用于减少流量以及增加带宽吞吐量，节流策略可以从每秒请求数，请求数据量，费用等维度进行配置。</p><p><strong>何时使用</strong></p><table><thead><tr><th>应用</th><th>功能</th><th>需要关注</th></tr></thead><tbody><tr><td>Live</td><td>对流量进行限制</td><td>-</td></tr><tr><td>Video</td><td>对流量进行限制</td><td>-</td></tr><tr><td>Shopping</td><td>对流量进行限制</td><td>-</td></tr></tbody></table><p><strong>需要关注</strong></p><p><a href="https://docs.microsoft.com/en-us/azure/architecture/patterns/rate-limiting-pattern#issues-and-considerations" target="_blank" rel="noopener noreferrer">Issues and considerations</a></p><p>Durable messaging system</p><blockquote><p>In scenarios where your APIs can handle requests faster than any throttled ingestion services allow, you&#x27;ll need to manage how quickly you can use the service. However, only treating the throttling as a data rate mismatch problem, and simply buffering your ingestion requests until the throttled service can catch up, is risky. If your application crashes in this scenario, you risk losing any of this buffered data.</p></blockquote><p>Improve throughput</p><blockquote><p>While not required, it&#x27;s often recommended to send smaller amounts of records more frequently to improve throughput. So rather than trying to batch things up for a release once a second or once a minute, you can be more granular than that to keep your resource consumption (memory, CPU, network, etc.) flowing at a more even rate, preventing potential bottlenecks due to sudden bursts of requests. For example, if a service allows 100 operations per second, the implementation of a rate limiter may even out requests by releasing 20 operations every 200 milliseconds, as shown in the following graph.</p></blockquote><p>Errors handle</p><blockquote><p>While the rate limiting pattern can reduce the number of throttling errors, your application will still need to properly handle any throttling errors that may occur.</p></blockquote><p>Integrate multiple workstreams into rate limiting strategy</p><blockquote><p>If your application has multiple workstreams that access the same throttled service, you&#x27;ll need to integrate all of them into your rate limiting strategy. For instance, you might support bulk loading records into a database but also querying for records in that same database. You can manage capacity by ensuring all workstreams are gated through the same rate limiting mechanism. Alternatively, you might reserve separate pools of capacity for each workstream.</p></blockquote><p><strong>如何执行</strong></p><p>具体策略请浏览：</p><ul><li><a href="https://docs.microsoft.com/en-us/azure/architecture/patterns/rate-limiting-pattern#issues-and-considerations" target="_blank" rel="noopener noreferrer">Solution</a></li></ul><p><strong>相关组件</strong></p><table><thead><tr><th>名称</th><th>特点</th><th>阅读</th></tr></thead><tbody><tr><td>Google Cloud Armor</td><td><ul><li>Adaptive protection</li><li>Bot management</li><li>Rate limiting</li></ul></td><td><a href="https://cloud.google.com/armor#section-2" target="_blank" rel="noopener noreferrer">Cloud Armor Key features</a></td></tr><tr><td>Amazon API Gateway</td><td><ul><li>Support for RESTful APIs and WebSocket APIs</li><li>API Operations Monitoring</li></ul></td><td><a href="https://aws.amazon.com/api-gateway/features/" target="_blank" rel="noopener noreferrer">Amazon API Gateway Features</a></td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="saga-distributed-transactions-pattern"><a href="https://docs.microsoft.com/en-us/azure/architecture/reference-architectures/saga/saga" target="_blank" rel="noopener noreferrer">Saga distributed transactions pattern</a><a href="#saga-distributed-transactions-pattern" class="hash-link" aria-label="Direct link to saga-distributed-transactions-pattern" title="Direct link to saga-distributed-transactions-pattern">​</a></h3><p>Saga 是一种故障处理 pattern，用于分布式应用程序中建立一致性，并协调多个微服务之间的事务以保持数据一致性。其使用 Choreography 和 Orchestration 实现 Compensating Transaction pattern </p><p><strong>何时使用</strong></p><table><thead><tr><th>应用</th><th>功能</th><th>需要关注</th></tr></thead><tbody><tr><td>Uber</td><td>叫车流程中出错（叫到车但是司机取消，自动重新叫车）还原司机以及乘客状态</td><td>Retry</td></tr><tr><td>File Sync</td><td>文件同步过程出错（文件夹名被占用，自动修改），还原文件状态</td><td>Retry</td></tr></tbody></table><p><strong>需要关注</strong></p><p><a href="https://learn.microsoft.com/en-us/azure/architecture/reference-architectures/saga/saga#issues-and-considerations" target="_blank" rel="noopener noreferrer">Issues and considerations</a></p><p>idempotence</p><blockquote><p>The implementation must be capable of handling a set of potential transient failures, and provide idempotence for reducing side-effects and ensuring data consistency.</p></blockquote><p>Lost updates, Dirty reads</p><blockquote><p>Lost updates, when one saga writes without reading changes made by another saga. Dirty reads, when a transaction or a saga reads updates made by a saga that has not yet completed those updates.</p></blockquote><p><strong>如何执行</strong></p><p>Choreography</p><blockquote><p>Choreography is a way to coordinate sagas where participants exchange events without a centralized point of control. With choreography, each local transaction publishes domain events that trigger local transactions in other services.</p></blockquote><p>Orchestration</p><blockquote><p>Orchestration is a way to coordinate sagas where a centralized controller tells the saga participants what local transactions to execute. The saga orchestrator handles all the transactions and tells the participants which operation to perform based on events. The orchestrator executes saga requests, stores and interprets the states of each task, and handles failure recovery with compensating transactions.</p></blockquote><p>具体策略请浏览：</p><ul><li><a href="https://learn.microsoft.com/en-us/azure/architecture/reference-architectures/saga/saga#solution" target="_blank" rel="noopener noreferrer">Solution</a></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="sharding-pattern"><a href="https://docs.microsoft.com/en-us/azure/architecture/patterns/sharding" target="_blank" rel="noopener noreferrer">Sharding pattern</a><a href="#sharding-pattern" class="hash-link" aria-label="Direct link to sharding-pattern" title="Direct link to sharding-pattern">​</a></h3><p>对数据存储进行水平划分，提高系统的 scalability 和 availability</p><p><strong>何时使用</strong></p><table><thead><tr><th>应用</th><th>功能</th><th>需要关注</th></tr></thead><tbody><tr><td>Newsfeed</td><td>对 news 进行 sharding</td><td></td></tr><tr><td>Live</td><td>对 video 进行 sharding</td><td></td></tr><tr><td>search</td><td>对查询内容进行 sharding</td><td></td></tr></tbody></table><p><strong>需要关注</strong></p><p><a href="https://learn.microsoft.com/en-us/azure/architecture/patterns/sharding#issues-and-considerations" target="_blank" rel="noopener noreferrer">Issues and considerations</a></p><p>Rebalance</p><blockquote><p>Rebalancing can be an expensive operation. To reduce the necessity of rebalancing, plan for growth by ensuring that each shard contains sufficient free space to handle the expected volume of changes. You should also develop strategies and scripts you can use to quickly rebalance shards if this becomes necessary.</p></blockquote><p>Use stable data for the shard key</p><blockquote><p>avoid basing the shard key on potentially volatile information. Instead, look for attributes that are invariant or that naturally form a key.</p></blockquote><p><strong>如何执行</strong></p><p>具体策略请浏览：</p><ul><li><a href="https://learn.microsoft.com/en-us/azure/architecture/patterns/sharding#solution" target="_blank" rel="noopener noreferrer">Solution</a></li><li><a href="https://learn.microsoft.com/en-us/previous-versions/msp-n-p/dn589795(v=pandp.10)" target="_blank" rel="noopener noreferrer">Data Partitioning Guidance</a></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="valet-key-pattern"><a href="https://docs.microsoft.com/en-us/azure/architecture/patterns/valet-key" target="_blank" rel="noopener noreferrer">Valet Key pattern</a><a href="#valet-key-pattern" class="hash-link" aria-label="Direct link to valet-key-pattern" title="Direct link to valet-key-pattern">​</a></h3><p>使用 token 进行鉴权，使用户可以直接访问资源，无需每次都经过服务器</p><p><strong>何时使用</strong></p><table><thead><tr><th>应用</th><th>功能</th><th>需要关注</th></tr></thead><tbody><tr><td>Newsfeed</td><td>上传图片和视频</td><td></td></tr><tr><td>Infrastructure</td><td>认证调用者，记录 quota</td><td></td></tr></tbody></table><p><strong>需要关注</strong></p><p><a href="https://learn.microsoft.com/en-us/azure/architecture/patterns/valet-key#issues-and-considerations" target="_blank" rel="noopener noreferrer">Issues and considerations</a></p><p>Manage the validity status and period of the key.</p><blockquote><p>A key can usually be revoked or disabled, depending on how it was issued. Server-side policies can be changed or, the server key it was signed with can be invalidated. Specify a short validity period to minimize the risk of allowing unauthorized operations to take place against the data store. However, if the validity period is too short, the client might not be able to complete the operation before the key expires.</p></blockquote><p>Control the level of access the key will provide</p><blockquote><p>Typically, the key should allow the user to only perform the actions necessary to complete the operation, such as read-only access if the client shouldn&#x27;t be able to upload data to the data store.</p></blockquote><p>Deliver the key securely</p><blockquote><p>It can be embedded in a URL that the user activates in a web page, or it can be used in a server redirection operation so that the download occurs automatically. Always use HTTPS to deliver the key over a secure channel.</p></blockquote><p><strong>如何执行</strong></p><p>具体策略请浏览：</p><ul><li><a href="https://learn.microsoft.com/en-us/azure/architecture/patterns/valet-key#solution" target="_blank" rel="noopener noreferrer">Solution</a></li></ul><p><img loading="lazy" alt="valet-key-pattern" src="/assets/images/valet-key-pattern-56d856f769fad75d513c261d8799e65c.png" width="616" height="316" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="通用设计模式">通用设计模式<a href="#通用设计模式" class="hash-link" aria-label="Direct link to 通用设计模式" title="Direct link to 通用设计模式">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="ambassador-pattern"><a href="https://docs.microsoft.com/en-us/azure/architecture/patterns/ambassador" target="_blank" rel="noopener noreferrer">Ambassador pattern</a><a href="#ambassador-pattern" class="hash-link" aria-label="Direct link to ambassador-pattern" title="Direct link to ambassador-pattern">​</a></h3><p>使用一个适配器来管理新系统与旧系统直接的数据交换</p><p><strong>需要关注</strong></p><p><a href="https://learn.microsoft.com/en-us/azure/architecture/patterns/ambassador#issues-and-considerations" target="_blank" rel="noopener noreferrer">Issues and considerations</a></p><p>Latency</p><blockquote><p>The proxy adds some latency overhead. Consider whether a client library, invoked directly by the application, is a better approach.</p></blockquote><p>Idempotent</p><blockquote><p>Consider the possible impact of including generalized features in the proxy. For example, the ambassador could handle retries, but that might not be safe unless all operations are idempotent.</p></blockquote><p><strong>如何执行</strong></p><p>具体策略请浏览：</p><ul><li><a href="https://learn.microsoft.com/en-us/azure/architecture/patterns/ambassador#solution" target="_blank" rel="noopener noreferrer">Solution</a></li></ul><p><img loading="lazy" alt="ambassador" src="/assets/images/ambassador-b3bd478013b1849e5ce1db9302990298.png" width="733" height="259" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="anti-corruption-layer-pattern"><a href="https://docs.microsoft.com/en-us/azure/architecture/patterns/anti-corruption-layer" target="_blank" rel="noopener noreferrer">Anti-corruption Layer pattern</a><a href="#anti-corruption-layer-pattern" class="hash-link" aria-label="Direct link to anti-corruption-layer-pattern" title="Direct link to anti-corruption-layer-pattern">​</a></h3><p>使用一个适配器来管理新系统与旧系统直接的数据交换</p><p><strong>何时使用</strong></p><table><thead><tr><th>应用</th><th>功能</th><th>需要关注</th></tr></thead><tbody><tr><td>Infrastructure</td><td>框架迁移，新旧系统交互</td><td></td></tr></tbody></table><p><strong>需要关注</strong></p><p><a href="https://learn.microsoft.com/en-us/azure/architecture/patterns/anti-corruption-layer#issues-and-considerations" target="_blank" rel="noopener noreferrer">Issues and considerations</a></p><p>Latency</p><blockquote><p>The anti-corruption layer may add latency to calls made between the two systems.</p></blockquote><p>Transaction</p><blockquote><p>Make sure transaction and data consistency are maintained and can be monitored.</p></blockquote><p><strong>如何执行</strong></p><p>具体策略请浏览：</p><ul><li><a href="https://learn.microsoft.com/en-us/azure/architecture/patterns/anti-corruption-layer#solution" target="_blank" rel="noopener noreferrer">Solution</a></li></ul><p><img loading="lazy" alt="anti-corruption-layer" src="/assets/images/anti-corruption-layer-c31e4f8e34701b920da849f10e756ebc.png" width="2913" height="1404" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="cache-aside-pattern"><a href="https://docs.microsoft.com/en-us/azure/architecture/patterns/cache-aside" target="_blank" rel="noopener noreferrer">Cache-Aside pattern</a><a href="#cache-aside-pattern" class="hash-link" aria-label="Direct link to cache-aside-pattern" title="Direct link to cache-aside-pattern">​</a></h3><p>使用缓存组件对数据进行分级存储，提高读取速度</p><p><strong>何时使用</strong></p><table><thead><tr><th>应用</th><th>功能</th><th>需要关注</th></tr></thead><tbody><tr><td>Video</td><td>使用 CDN 和 POP 缓存热门视频</td><td>热门视频提前预热，定时更新缓存视频</td></tr><tr><td>Ranking</td><td>对排名结果进行缓存</td><td>定期计算排名并且更新缓存</td></tr><tr><td>Search</td><td>对搜索结果进行缓存</td><td>定期计算搜索结果并且更新缓存</td></tr></tbody></table><p><strong>需要关注</strong></p><p><a href="https://docs.microsoft.com/en-us/azure/architecture/patterns/cache-aside#issues-and-considerations" target="_blank" rel="noopener noreferrer">Issues and considerations</a></p><p>Lifetime of cached data</p><blockquote><p>Don&#x27;t make the expiration period too short because this can cause applications to continually retrieve data from the data store and add it to the cache. Similarly, don&#x27;t make the expiration period so long that the cached data is likely to become stale. </p></blockquote><p>Evicting data</p><blockquote><p>Most caches adopt a least-recently-used policy for selecting items to evict, but this might be customizable.</p></blockquote><p>Priming the cache</p><blockquote><p>Many solutions prepopulate the cache with the data that an application is likely to need as part of the startup processing.</p></blockquote><p>Consistency</p><blockquote><p>Implementing the Cache-Aside pattern doesn&#x27;t guarantee consistency between the data store and the cache.</p></blockquote><p>Local (in-memory) caching</p><blockquote><p>This data could quickly become inconsistent between caches, so it might be necessary to expire data held in a private cache and refresh it more frequently. In these scenarios, consider investigating the use of a shared or a distributed caching mechanism.</p></blockquote><p><strong>如何执行</strong></p><p>读取数据：</p><ol><li>检查缓存是否有数据，有的话从缓存返回</li><li>如果没有的话，从持久化存储中读取数据</li><li>将数据写入缓存</li></ol><p>写数据：</p><ol><li>将数据写入持久化存储</li><li>从缓存删除数据</li></ol><p><strong>相关组件</strong></p><table><thead><tr><th>名称</th><th>特点</th><th>阅读</th></tr></thead><tbody><tr><td>Redis</td><td><ul><li>atomic operations</li><li>in-memory dataset</li><li>asynchronous replication</li></ul></td><td><a href="https://redis.io/docs/about/" target="_blank" rel="noopener noreferrer">Introduction to Redis</a></td></tr><tr><td>Memorystore</td><td><ul><li>supports both Redis and Memcached and is fully protocol compatible</li><li>Provisioning, replication, failover, and patching are all automated</li><li>Highly scalable &amp; Highly available</li></ul></td><td><a href="https://cloud.google.com/memorystore" target="_blank" rel="noopener noreferrer">Memorystore</a></td></tr><tr><td>Amazon ElastiCache</td><td><ul><li>Support for two engines: Memcached and Redis</li><li>Ease of management via the AWS Management Console</li><li>Detailed monitoring statistics for the engine nodes at no extra cost via Amazon CloudWatch</li></ul></td><td><a href="https://aws.amazon.com/elasticache/features/?nc=sn&amp;loc=3" target="_blank" rel="noopener noreferrer">Amazon ElastiCache features</a></td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="health-endpoint-monitoring-pattern"><a href="https://docs.microsoft.com/en-us/azure/architecture/patterns/health-endpoint-monitoring" target="_blank" rel="noopener noreferrer">Health Endpoint Monitoring pattern</a><a href="#health-endpoint-monitoring-pattern" class="hash-link" aria-label="Direct link to health-endpoint-monitoring-pattern" title="Direct link to health-endpoint-monitoring-pattern">​</a></h3><p>定时请求服务器检查其健康状况</p><p><strong>何时使用</strong></p><table><thead><tr><th>应用</th><th>功能</th><th>需要关注</th></tr></thead></table><p><strong>需要关注</strong></p><p><a href="https://learn.microsoft.com/en-us/azure/architecture/patterns/health-endpoint-monitoring#issues-and-considerations" target="_blank" rel="noopener noreferrer">Issues and considerations</a></p><p>How to validate the response. </p><blockquote><p>While this provides the most basic measure of application availability, and is the minimum implementation of this pattern, it provides little information about the operations, trends, and possible upcoming issues in the application.</p></blockquote><p>Security</p><blockquote><p>To protect them from public access, which might expose the application to malicious attacks, risk the exposure of sensitive information, or attract denial of service (DoS) attacks. </p></blockquote><p><strong>如何执行</strong></p><p>具体策略请浏览：</p><ul><li><a href="https://learn.microsoft.com/en-us/azure/architecture/patterns/health-endpoint-monitoring#solution" target="_blank" rel="noopener noreferrer">Solution</a></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="retry-pattern--circuit-breaker-pattern"><a href="https://docs.microsoft.com/en-us/azure/architecture/patterns/retry" target="_blank" rel="noopener noreferrer">Retry pattern</a> &amp; <a href="https://docs.microsoft.com/en-us/azure/architecture/patterns/choreography" target="_blank" rel="noopener noreferrer">Circuit Breaker pattern</a><a href="#retry-pattern--circuit-breaker-pattern" class="hash-link" aria-label="Direct link to retry-pattern--circuit-breaker-pattern" title="Direct link to retry-pattern--circuit-breaker-pattern">​</a></h3><p>使用代理策略对重试功能进行管理和限制，防止出现大量重试导致原本崩溃的组件无法恢复以及耗用过多重试资源。</p><p><strong>何时使用</strong></p><table><thead><tr><th>应用</th><th>功能</th><th>需要关注</th></tr></thead><tbody><tr><td>News Feed</td><td>对消息发送失败进行重试</td><td>Exception Handling, Logging</td></tr><tr><td>IM</td><td>对消息发送失败进行重试</td><td>Exception Handling, Logging</td></tr><tr><td>File Sync</td><td>对业务操作进行重试（更新文件）</td><td>Retry after delay</td></tr></tbody></table><p><strong>需要关注</strong></p><p><a href="https://docs.microsoft.com/en-us/azure/architecture/patterns/retry#solution" target="_blank" rel="noopener noreferrer">Retry Issues and considerations</a>
<a href="https://docs.microsoft.com/en-us/azure/architecture/patterns/circuit-breaker" target="_blank" rel="noopener noreferrer">Circuit Breaker Issues and considerations</a></p><p>Fail fast</p><blockquote><p>For some noncritical operations, it&#x27;s better to fail fast rather than retry several times and impact the throughput of the application.</p></blockquote><p>Exception Handling</p><blockquote><p>A request to a service can fail for a variety of reasons raising different exceptions depending on the nature of the failure. Some exceptions indicate a failure that can be resolved quickly, while others indicate that the failure is longer lasting. It&#x27;s useful for the retry policy to adjust the time between retry attempts based on the type of the exception.</p></blockquote><p>Idempotent</p><blockquote><p>retries could cause the operation to be executed more than once, with unintended side effects</p></blockquote><p>Logging</p><blockquote><p>It&#x27;s important to log all connectivity failures that cause a retry so that underlying problems with the application, services, or resources can be identified.</p></blockquote><p><strong>如何执行</strong></p><p>具体策略请浏览：</p><ul><li><a href="https://docs.microsoft.com/en-us/azure/architecture/patterns/retry#solution" target="_blank" rel="noopener noreferrer">Solution</a></li><li><a href="https://docs.microsoft.com/en-us/azure/architecture/patterns/circuit-breaker#solution" target="_blank" rel="noopener noreferrer">Solution</a></li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/Interview-Science/Book/edit/main/docs/系统设计/设计模式.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/系统设计/基础组件"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">基本组件</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/系统设计/分类总结/信息流系统"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">信息流系统</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#特定设计模式" class="table-of-contents__link toc-highlight">特定设计模式</a><ul><li><a href="#asynchronous-request-reply-pattern" class="table-of-contents__link toc-highlight">Asynchronous Request-Reply Pattern</a></li><li><a href="#compensating-transaction-pattern" class="table-of-contents__link toc-highlight">Compensating Transaction pattern</a></li><li><a href="#competing-consumers-pattern" class="table-of-contents__link toc-highlight">Competing Consumers pattern</a></li><li><a href="#event-sourcing-pattern" class="table-of-contents__link toc-highlight">Event Sourcing pattern</a></li><li><a href="#cqrs-pattern" class="table-of-contents__link toc-highlight">CQRS pattern</a></li><li><a href="#gatekeeper-pattern" class="table-of-contents__link toc-highlight">Gatekeeper pattern</a></li><li><a href="#geode-pattern" class="table-of-contents__link toc-highlight">Geode pattern</a></li><li><a href="#rate-limiting-pattern" class="table-of-contents__link toc-highlight">Rate Limiting pattern</a></li><li><a href="#saga-distributed-transactions-pattern" class="table-of-contents__link toc-highlight">Saga distributed transactions pattern</a></li><li><a href="#sharding-pattern" class="table-of-contents__link toc-highlight">Sharding pattern</a></li><li><a href="#valet-key-pattern" class="table-of-contents__link toc-highlight">Valet Key pattern</a></li></ul></li><li><a href="#通用设计模式" class="table-of-contents__link toc-highlight">通用设计模式</a><ul><li><a href="#ambassador-pattern" class="table-of-contents__link toc-highlight">Ambassador pattern</a></li><li><a href="#anti-corruption-layer-pattern" class="table-of-contents__link toc-highlight">Anti-corruption Layer pattern</a></li><li><a href="#cache-aside-pattern" class="table-of-contents__link toc-highlight">Cache-Aside pattern</a></li><li><a href="#health-endpoint-monitoring-pattern" class="table-of-contents__link toc-highlight">Health Endpoint Monitoring pattern</a></li><li><a href="#retry-pattern--circuit-breaker-pattern" class="table-of-contents__link toc-highlight">Retry pattern &amp; Circuit Breaker pattern</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/Interview-Science" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Interview Science, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.3e011891.js"></script>
<script src="/assets/js/main.1a592133.js"></script>
</body>
</html>