---
sidebar_position: 50
---

# 设计模式与常见问题

## 系统架构

### Event-driven architectures

**Q: How would you design the event-driven architecture for a  newsfeed?**

A: The design would involve a publish-subscribe model where user actions are events that are published to a messaging system. Subscribers, such as the newsfeed service, would consume these events to update the feed.

- Event producers: User actions (post, like, comment, share).
- Event consumers: Newsfeed service, notification service.
- Event brokers: Kafka, RabbitMQ, or AWS SNS/SQS.
- Datastores: NoSQL databases like Cassandra for the feed, Elasticsearch for search.
- Caching: Memcached or Redis to cache hot data.
- Feed generation: Real-time vs. pre-generated feeds using fan-out on write or lazy loading strategies.

**Q: How would you handle peak traffic in an event-driven live streaming service like Facebook Live?**

A: To handle peak traffic, we can:

- Use a scalable messaging system to handle the surge in events.
- Implement backpressure mechanisms to manage event flow.
- Utilize auto-scaling in the cloud to dynamically allocate resources.
- Employ load balancers to distribute traffic evenly.
- Integrate a CDN for media distribution to reduce latency.
- Optimize the stream's bit rate based on user bandwidth.

Q: "How can you ensure ordered delivery of product purchase events in an e-commerce platform like Amazon?"

A: "Use a message queuing system that supports ordered delivery, such as Amazon SQS FIFO queues, which ensure messages are processed exactly once and in the order they are sent."

Q: "How would you ensure consistency across distributed services in an event-driven architecture for an e-commerce platform?"

A: "Implement the CQRS pattern to separate the write model (commands) from the read model (queries). Use event sourcing to ensure all changes are captured as events, which can then be projected into the read model, ensuring eventual consistency across the services."

**Examples**
1. [Stream analytics](https://cloud.google.com/pubsub#stream-analytics)

**Resources**
1. [Event-driven architectures](https://cloud.google.com/eventarc/docs/event-driven-architectures)
2. [What is an Event-Driven Architecture?](https://aws.amazon.com/event-driven-architecture/)

### Serverless architecture

### Microservice

## 交互与发布

### Asynchronous Request-Reply Pattern

### Publisher-Subscriber Pattern

## 数据管理

### CQRS Pattern

### Event Sourcing Pattern

### Sharding Pattern

### Geode Pattern

## 一致性与安全

### Compensating Transaction Pattern

### Saga Distributed Transactions Pattern

### Valet Key Pattern

## 缓存与效率

### Cache-Aside Pattern

### Rate Limiting Pattern

### Fan-Out/Fan-In Strategy

## 通用

### Ambassador Pattern

### Anti-corruption Layer Pattern

### Gatekeeper Pattern

### Health Endpoint Monitoring Pattern

### Retry Pattern & Circuit Breaker Pattern

