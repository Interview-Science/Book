---
sidebar_position: 5
---

- 资料来源：[Building a streaming video analytics pipeline](https://cloud.google.com/architecture/building-a-streaming-video-analytics-pipeline)
- 使用场景：系统可以对视频进行实时分析

![build-streaming-video-analytics-pipeline-01](/img/system/build-streaming-video-analytics-pipeline-01.svg)

1. 客户端应用将源视频文件上传到 Cloud Storage 存储分区。
2. 对于每项文件上传操作，系统会通过向 Pub/Sub 发布消息自动通知客户端。
3. 对于每条新通知，Dataflow 流水线都会执行以下操作：
4. 从 Pub/Sub 消息中读取文件元数据。
5. 将文件加载到内存中，并将其拆分为数个 5 秒的片段。
6. 将每个片段发送至 Video Intelligence API，后者随后会返回注释。
7. 将所有注释都存储在 BigQuery 表中。
8. 对于包含流水线的可自定义参数指定的有意义注释的视频片段（例如，包含人物的所有片段），将输出消息发送到 Pub/Sub。
9. 消费者应用从 Pub/Sub 读取输出消息以显示过滤的注释。
